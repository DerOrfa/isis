<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ISIS Core Library: /SCR/isis/lib/Core/DataStorage/image.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>/SCR/isis/lib/Core/DataStorage/image.hpp</h1><a href="image_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">// C++ Interface: image</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// Description:</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//</span>
<a name="l00007"></a>00007 <span class="comment">// Author: Enrico Reimer&lt;reimer@cbs.mpg.de&gt;, (C) 2009</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">// Copyright: See COPYING file that comes with this distribution</span>
<a name="l00010"></a>00010 <span class="comment">//</span>
<a name="l00011"></a>00011 <span class="comment">//</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#ifndef IMAGE_H</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_H</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span>
<a name="l00016"></a>00016 <span class="preprocessor">#include "<a class="code" href="chunk_8hpp.html">chunk.hpp</a>"</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;set&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;boost/shared_ptr.hpp&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;boost/foreach.hpp&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;boost/numeric/ublas/matrix.hpp&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;stack&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include "<a class="code" href="sortedchunklist_8hpp.html">sortedchunklist.hpp</a>"</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="keyword">namespace </span>isis
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028 <span class="keyword">namespace </span>data
<a name="l00029"></a>00029 {
<a name="l00030"></a>00030 
<a name="l00031"></a><a class="code" href="classisis_1_1data_1_1Image.html">00031</a> <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1Image.html">Image</a>:
<a name="l00032"></a>00032     <span class="keyword">public</span> _internal::NDimensional&lt;4&gt;,
<a name="l00033"></a>00033     <span class="keyword">public</span> util::PropMap
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035 <span class="keyword">public</span>:
<a name="l00036"></a><a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd6330d4cbf4f6526d1d6895c71e6bea6542c">00036</a>     <span class="keyword">enum</span> <a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd633">orientation</a> {<a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd633ee38808f2b23291db3fbb0aebe7ba405">axial</a>, <a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd63364a137c1013ea7f831d25c8701c0693d">reversed_axial</a>, <a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd6330d4cbf4f6526d1d6895c71e6bea6542c">sagittal</a>, <a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd6333adbf32c9b5579e6e97586301f48e047">reversed_sagittal</a>, <a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd633d77b748bff3861529f19469104a94e6c">coronal</a>, <a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd633f6335ced67866cc519e297f42ee64caa">reversed_coronal</a>};
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="keyword">protected</span>:
<a name="l00039"></a><a class="code" href="classisis_1_1data_1_1Image.html#f3656b415fa1872a8da29f82cb98ed6e">00039</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1SortedChunkList.html">_internal::SortedChunkList</a> <span class="keyword">set</span>;
<a name="l00040"></a><a class="code" href="classisis_1_1data_1_1Image.html#9c80a4fa8768d5df1c8bf67129e2cae9">00040</a>     std::vector&lt;boost::shared_ptr&lt;Chunk&gt; &gt; <a class="code" href="classisis_1_1data_1_1Image.html#9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a>;
<a name="l00041"></a>00041 <span class="keyword">private</span>:
<a name="l00042"></a>00042     <span class="keywordtype">bool</span> clean;
<a name="l00043"></a>00043     <span class="keywordtype">size_t</span> chunkVolume;
<a name="l00044"></a>00044 
<a name="l00050"></a>00050     <span class="keyword">const</span> boost::shared_ptr&lt;Chunk&gt; &amp;chunkPtrAt( <span class="keywordtype">size_t</span> at )<span class="keyword">const</span>;
<a name="l00051"></a>00051 
<a name="l00063"></a>00063     <span class="keyword">inline</span> std::pair&lt;size_t, size_t&gt; commonGet ( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second, <span class="keywordtype">size_t</span> third, <span class="keywordtype">size_t</span> fourth )<span class="keyword"> const </span>{
<a name="l00064"></a>00064         <span class="keyword">const</span> <span class="keywordtype">size_t</span> idx[] = {first, second, third, fourth};
<a name="l00065"></a>00065         <a class="code" href="log_8hpp.html#977f6c27373576d6ffe1523fc2afb8b6">LOG_IF</a>( ! clean, <a class="code" href="namespaceisis_1_1data.html#1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="group__util.html#ggfe55030315ca143f9be26fd278df9f8241a0a4591faa6079940551ad22c43597">error</a> )
<a name="l00066"></a>00066                 &lt;&lt; <span class="stringliteral">"Getting data from a non indexed image will result in undefined behavior. Run reIndex first."</span>;
<a name="l00067"></a>00067         <a class="code" href="log_8hpp.html#977f6c27373576d6ffe1523fc2afb8b6">LOG_IF</a>( <span class="keyword">set</span>.<a class="code" href="classisis_1_1data_1_1Image.html#b5afb05390412eb68388cb79a6f7f50a">empty</a>(), <a class="code" href="namespaceisis_1_1data.html#1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="group__util.html#ggfe55030315ca143f9be26fd278df9f8241a0a4591faa6079940551ad22c43597">error</a> )
<a name="l00068"></a>00068                 &lt;&lt; <span class="stringliteral">"Getting data from a empty image will result in undefined behavior."</span>;
<a name="l00069"></a>00069         <a class="code" href="log_8hpp.html#977f6c27373576d6ffe1523fc2afb8b6">LOG_IF</a>( !<a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#7c7e105bb1b3f1f506eeb98d48623816" title="Check if index fits into size of the object.">rangeCheck</a>( idx ), <a class="code" href="namespaceisis_1_1data.html#1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="group__util.html#ggfe55030315ca143f9be26fd278df9f8241a0a4591faa6079940551ad22c43597">isis::error</a> )
<a name="l00070"></a>00070                 &lt;&lt; <span class="stringliteral">"Index "</span> &lt;&lt; <a class="code" href="namespaceisis_1_1util.html#7380ff4230bcf475cfb406105fb0820f" title="use write_list to create a string from a list">util::list2string</a>( idx, idx + 4, <span class="stringliteral">"|"</span> ) &lt;&lt; <span class="stringliteral">" is out of range ("</span> &lt;&lt; <a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#da5042d68f01ea4bf9b3edf0e08b20d9" title="generates a string representing the size">sizeToString</a>() &lt;&lt; <span class="stringliteral">")"</span>;
<a name="l00071"></a>00071         <span class="keyword">const</span> <span class="keywordtype">size_t</span> index = <a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#bf1ad4a9ece3e8866cd0c52d7e5be256" title="Compute linear index from n-dimensional index,.">dim2Index</a>( idx );
<a name="l00072"></a>00072         <span class="keywordflow">return</span> std::make_pair( index / chunkVolume, index % chunkVolume );
<a name="l00073"></a>00073     }
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="keyword">protected</span>:
<a name="l00077"></a><a class="code" href="classisis_1_1data_1_1Image.html#aa5072c5a9d97873c38822fe1c674387">00077</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classisis_1_1data_1_1Image.html#aa5072c5a9d97873c38822fe1c674387">needed</a>;
<a name="l00078"></a>00078 
<a name="l00097"></a>00097     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#ece4ae886cea93d0e05087c9b3e2c85b" title="Search for a dimensional break in all stored chunks.">getChunkStride</a>( <span class="keywordtype">size_t</span> base_stride = 1 );
<a name="l00103"></a>00103     <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> &amp;<a class="code" href="classisis_1_1data_1_1Image.html#087ed8c4884cea467e47c386c65d5be2" title="Access a chunk via index (and the lookup table) The Chunk will only have metadata...">chunkAt</a>( <span class="keywordtype">size_t</span> at );
<a name="l00104"></a>00104 <span class="keyword">public</span>:
<a name="l00106"></a>00106     <a class="code" href="classisis_1_1data_1_1Image.html#fe4f8006b3f04f60f68b5027ed8bbebc" title="Creates an empty Image object.">Image</a>();
<a name="l00107"></a>00107 
<a name="l00112"></a>00112     <a class="code" href="classisis_1_1data_1_1Image.html#fe4f8006b3f04f60f68b5027ed8bbebc" title="Creates an empty Image object.">Image</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a> &amp;ref );
<a name="l00113"></a>00113 
<a name="l00118"></a>00118     <a class="code" href="classisis_1_1data_1_1Image.html">Image</a> &amp;<a class="code" href="classisis_1_1data_1_1Image.html#ae95616fad335432d8ce3b5e5daf004a" title="Copy operator.">operator=</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a> &amp;ref );
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#cd213fa6d0856d45e6413801f9bdec66">checkMakeClean</a>();
<a name="l00138"></a><a class="code" href="classisis_1_1data_1_1Image.html#31aecea5e2a012d677c59222ebe13198">00138</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; T &amp;<a class="code" href="classisis_1_1data_1_1Image.html#31aecea5e2a012d677c59222ebe13198" title="This method returns a reference to the voxel value at the given coordinates.">voxel</a>( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0 ) {
<a name="l00139"></a>00139         <a class="code" href="classisis_1_1data_1_1Image.html#cd213fa6d0856d45e6413801f9bdec66">checkMakeClean</a>();
<a name="l00140"></a>00140         <span class="keyword">const</span> std::pair&lt;size_t, size_t&gt; index = commonGet( first, second, third, fourth );
<a name="l00141"></a>00141         <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;T&gt;</a> &amp;data = <a class="code" href="classisis_1_1data_1_1Image.html#087ed8c4884cea467e47c386c65d5be2" title="Access a chunk via index (and the lookup table) The Chunk will only have metadata...">chunkAt</a>( index.first ).<a class="code" href="classisis_1_1data_1_1Chunk.html#47765597588ad4688047930e95b8a237">asTypePtr</a>&lt;T&gt;();
<a name="l00142"></a>00142         <span class="keywordflow">return</span> data[index.second];
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144 
<a name="l00160"></a><a class="code" href="classisis_1_1data_1_1Image.html#da9507a974c95aba6869636e5df4a306">00160</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; T <a class="code" href="classisis_1_1data_1_1Image.html#31aecea5e2a012d677c59222ebe13198" title="This method returns a reference to the voxel value at the given coordinates.">voxel</a>( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0 )<span class="keyword">const </span>{
<a name="l00161"></a>00161         <span class="keyword">const</span> std::pair&lt;size_t, size_t&gt; index = commonGet( first, second, third, fourth );
<a name="l00162"></a>00162         <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;T&gt;</a> &amp;data = chunkPtrAt( index.first )-&gt;getTypePtr&lt;T&gt;();
<a name="l00163"></a>00163         <span class="keywordflow">return</span> data[index.second];
<a name="l00164"></a>00164     }
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 
<a name="l00175"></a>00175     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classisis_1_1data_1_1Image.html#0e1813b7ad96b056317c0282794202ec" title="Get the type of the chunk with &amp;quot;biggest&amp;quot; type.">typeID</a>() <span class="keyword">const</span>;
<a name="l00177"></a>00177     std::string <a class="code" href="classisis_1_1data_1_1Image.html#22eb142b9e736863f33ffffdf6a2a9f8">typeName</a>() <span class="keyword">const</span>;
<a name="l00178"></a>00178 
<a name="l00184"></a>00184     <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#27cfa5f9ced2077e578ad4bcc064e028" title="Get a chunk via index (and the lookup table).">getChunkAt</a>( <span class="keywordtype">size_t</span> at, <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> )<span class="keyword">const</span>;
<a name="l00185"></a>00185 
<a name="l00199"></a>00199     <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#fda7218833647cc6526950524775140d" title="Get the chunk that contains the voxel at the given coordinates.">getChunk</a>( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0, <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> )<span class="keyword">const</span>;
<a name="l00200"></a>00200 
<a name="l00213"></a>00213     <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#fda7218833647cc6526950524775140d" title="Get the chunk that contains the voxel at the given coordinates.">getChunk</a>( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0, <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> );
<a name="l00214"></a>00214 
<a name="l00220"></a>00220     std::vector&lt;boost::shared_ptr&lt;Chunk&gt; &gt; <a class="code" href="classisis_1_1data_1_1Image.html#75347e303a9bf31ddb5e97e386342db6" title="Get a sorted list of pointers to the chunks of the image.">getChunkList</a>();
<a name="l00222"></a>00222     std::vector&lt;boost::shared_ptr&lt;const Chunk&gt; &gt; <a class="code" href="classisis_1_1data_1_1Image.html#75347e303a9bf31ddb5e97e386342db6" title="Get a sorted list of pointers to the chunks of the image.">getChunkList</a>()<span class="keyword">const</span>;
<a name="l00223"></a>00223 
<a name="l00236"></a><a class="code" href="classisis_1_1data_1_1Image.html#9331c45a182600e3f18c4e14cab73962">00236</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TYPE&gt; <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#9331c45a182600e3f18c4e14cab73962" title="Get the chunk that contains the voxel at the given coordinates in the given type...">getChunkAs</a>( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0 )<span class="keyword">const </span>{
<a name="l00237"></a>00237         <span class="keywordflow">return</span> getChunkAs&lt;TYPE&gt;( <a class="code" href="classisis_1_1data_1_1Image.html#789138e66345f3e5a73c65dbf05b2940" title="for each chunk get the scaling (and offset) which would be used in an conversion...">getScalingTo</a>( <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;TYPE&gt;::staticID</a> ), first, second, third, fourth );
<a name="l00238"></a>00238     }
<a name="l00250"></a><a class="code" href="classisis_1_1data_1_1Image.html#394dc97182639545c2cc34ce6284b95d">00250</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TYPE&gt; <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#9331c45a182600e3f18c4e14cab73962" title="Get the chunk that contains the voxel at the given coordinates in the given type...">getChunkAs</a>( <span class="keyword">const</span> <a class="code" href="namespaceisis_1_1data.html#652d0963aeb92747bb0f48bee4652afd">scaling_pair</a> &amp;scaling, <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0 )<span class="keyword">const </span>{
<a name="l00251"></a>00251         <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> ret = <a class="code" href="classisis_1_1data_1_1Image.html#fda7218833647cc6526950524775140d" title="Get the chunk that contains the voxel at the given coordinates.">getChunk</a>( first, second, third, fourth ); <span class="comment">// get a cheap copy</span>
<a name="l00252"></a>00252         ret.<a class="code" href="classisis_1_1data_1_1Chunk.html#61ca98309e14cec0d310af35e4e9770c" title="Ensure, the chunk has the type with the requested id.">makeOfTypeId</a>( <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;TYPE&gt;::staticID</a>, scaling ); <span class="comment">// make it of type T</span>
<a name="l00253"></a>00253         <span class="keywordflow">return</span> ret; <span class="comment">//return that</span>
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255 
<a name="l00257"></a>00257     <a class="code" href="namespaceisis_1_1data.html#652d0963aeb92747bb0f48bee4652afd">scaling_pair</a> <a class="code" href="classisis_1_1data_1_1Image.html#789138e66345f3e5a73c65dbf05b2940" title="for each chunk get the scaling (and offset) which would be used in an conversion...">getScalingTo</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classisis_1_1data_1_1Image.html#0e1813b7ad96b056317c0282794202ec" title="Get the type of the chunk with &amp;quot;biggest&amp;quot; type.">typeID</a>, <a class="code" href="namespaceisis_1_1data.html#69354ef53dcb79cbe577ae5fe8764e49">autoscaleOption</a> scaleopt = <a class="code" href="namespaceisis_1_1data.html#69354ef53dcb79cbe577ae5fe8764e493a9ca3fecf5ccbb0f9d787d31a9edd2f">autoscale</a> )<span class="keyword">const</span>;
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 
<a name="l00268"></a>00268     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#14a33c4d2ba857b38c2188fb8e8abfd9" title="Insert a Chunk into the Image.">insertChunk</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> &amp;chunk );
<a name="l00274"></a>00274     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#801a02eb15ae94b384aaa97061e2ad1c" title="(Re)computes the image layout and metadata.">reIndex</a>();
<a name="l00275"></a>00275 
<a name="l00277"></a>00277     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#b5afb05390412eb68388cb79a6f7f50a">empty</a>()<span class="keyword">const</span>;
<a name="l00278"></a>00278 
<a name="l00284"></a>00284     std::list&lt;util::PropertyValue&gt; <a class="code" href="classisis_1_1data_1_1Image.html#af07f078753a69b7b00f287953778ed6" title="Get a list of the properties of the chunks for the given key.">getChunksProperties</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1util_1_1PropMap.html#83144c1481dbf7244cdfd4ebc90adfab">util::PropMap::pname_type</a> &amp;key, <span class="keywordtype">bool</span> unique = <span class="keyword">false</span> )<span class="keyword">const</span>;
<a name="l00285"></a>00285 
<a name="l00287"></a>00287     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#3d14f900dc0617a26096718aad9568d7" title="get the size of every voxel (in bytes)">bytes_per_voxel</a>()<span class="keyword">const</span>;
<a name="l00288"></a>00288 
<a name="l00293"></a><a class="code" href="classisis_1_1data_1_1Image.html#b93169697b9ccf6cb81b2ebd4a6837d0">00293</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1Image.html#b93169697b9ccf6cb81b2ebd4a6837d0" title="Get the maximum and the minimum voxel value of the image.">getMinMax</a>( T &amp;min, T &amp;max )<span class="keyword">const </span>{
<a name="l00294"></a>00294         <a class="code" href="structisis_1_1util_1_1check__type.html" title="Templated pseudo struct to check for availability of a type at compile time.">util::check_type&lt;T&gt;</a>();<span class="comment">// works only for T from _internal::types</span>
<a name="l00295"></a>00295         <a class="code" href="classisis_1_1util_1_1__internal_1_1TypeReference.html">util::TypeReference</a> _min, _max;
<a name="l00296"></a>00296         <a class="code" href="classisis_1_1data_1_1Image.html#b93169697b9ccf6cb81b2ebd4a6837d0" title="Get the maximum and the minimum voxel value of the image.">getMinMax</a>( _min, _max );
<a name="l00297"></a>00297         min = _min-&gt;as&lt;T&gt;();
<a name="l00298"></a>00298         max = _max-&gt;as&lt;T&gt;();
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300 
<a name="l00302"></a>00302     <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1Image.html#b93169697b9ccf6cb81b2ebd4a6837d0" title="Get the maximum and the minimum voxel value of the image.">getMinMax</a>( <a class="code" href="classisis_1_1util_1_1__internal_1_1TypeReference.html">util::TypeReference</a> &amp;min, <a class="code" href="classisis_1_1util_1_1__internal_1_1TypeReference.html">util::TypeReference</a> &amp;max )<span class="keyword">const</span>;
<a name="l00303"></a>00303 
<a name="l00308"></a>00308     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#713bf9b2de4c1c8ca26d79cf665141d6" title="Compares the voxel-values of this image to the given.">cmp</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a> &amp;comp )<span class="keyword">const</span>;
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <a class="code" href="classisis_1_1data_1_1Image.html#c83f7eecffd172b0c0759cb5ee7dd633">orientation</a> <a class="code" href="classisis_1_1data_1_1Image.html#5d4c287dbd53f05174f3070029e19ce9">getMainOrientation</a>()<span class="keyword">const</span>;
<a name="l00323"></a><a class="code" href="classisis_1_1data_1_1Image.html#08a00900007d599e698e56a430e88c19">00323</a>     <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1Image.html#08a00900007d599e698e56a430e88c19" title="Transforms the image coordinate system into an other system by multiplying the orientation...">transformCoords</a>( boost::numeric::ublas::matrix&lt;float&gt; <a class="code" href="classisis_1_1util_1_1PropMap.html#3997540abdffd6f8cda3732058c4019e" title="Transform an existing property into another.">transform</a> ) {
<a name="l00324"></a>00324         <a class="code" href="namespaceisis_1_1data_1_1__internal.html#83d86e81f0fcdeddecef0ed0f7768c92">isis::data::_internal::transformCoords</a>( *<span class="keyword">this</span>, transform );
<a name="l00325"></a>00325     }
<a name="l00326"></a>00326 
<a name="l00331"></a><a class="code" href="classisis_1_1data_1_1Image.html#6828f1a6b951b3e171152287fd4a6184">00331</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1Image.html#6828f1a6b951b3e171152287fd4a6184" title="Copy all voxel data of the image into memory.">copyToMem</a>( T *dst )<span class="keyword">const </span>{
<a name="l00332"></a>00332         <span class="keywordflow">if</span>( <a class="code" href="classisis_1_1data_1_1Image.html#cd213fa6d0856d45e6413801f9bdec66">checkMakeClean</a>() ) {
<a name="l00333"></a>00333             <a class="code" href="namespaceisis_1_1data.html#652d0963aeb92747bb0f48bee4652afd">scaling_pair</a> scale = <a class="code" href="classisis_1_1data_1_1Image.html#789138e66345f3e5a73c65dbf05b2940" title="for each chunk get the scaling (and offset) which would be used in an conversion...">getScalingTo</a>( <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;T&gt;::staticID</a> );
<a name="l00334"></a>00334             <span class="comment">// we could do this using makeOfTypeId - but this solution does not need any additional temporary memory</span>
<a name="l00335"></a>00335             BOOST_FOREACH( <span class="keyword">const</span> boost::shared_ptr&lt;Chunk&gt; &amp;ref, <a class="code" href="classisis_1_1data_1_1Image.html#9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a> ) {
<a name="l00336"></a>00336                 <span class="keywordflow">if</span>( !ref-&gt;copyToMem&lt;T&gt;( dst, scale ) ) {
<a name="l00337"></a>00337                     <a class="code" href="log_8hpp.html#df04aa30f03b88d867f551c7d349f738">LOG</a>( <a class="code" href="namespaceisis_1_1data.html#15b301b1e8962fdf9562e683d7be5d9f">Runtime</a>, <a class="code" href="group__util.html#ggfe55030315ca143f9be26fd278df9f8241a0a4591faa6079940551ad22c43597">error</a> ) &lt;&lt; <span class="stringliteral">"Failed to copy raw data of type "</span> &lt;&lt; ref-&gt;typeName() &lt;&lt; <span class="stringliteral">" from image into memory of type "</span> &lt;&lt; <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;T&gt;::staticName</a>();
<a name="l00338"></a>00338                 }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340                 dst += ref-&gt;volume(); <span class="comment">// increment the cursor</span>
<a name="l00341"></a>00341             }
<a name="l00342"></a>00342         }
<a name="l00343"></a>00343     }
<a name="l00350"></a>00350     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#ea5977c8de15ec5bc9f2e646ee48bca6" title="Ensure, the image has the type with the requested id.">makeOfTypeId</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">id</span> );
<a name="l00351"></a>00351 
<a name="l00356"></a>00356     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#94fda5b511c9bfdff550d9691937aea1" title="Automatically splice the given dimension and all dimensions above.">spliceDownTo</a>( <a class="code" href="namespaceisis_1_1data.html#157a8a81ce7fb08f84af9c27b7d251a3">dimensions</a> dim );
<a name="l00357"></a>00357 };
<a name="l00358"></a>00358 
<a name="l00359"></a><a class="code" href="classisis_1_1data_1_1MemImage.html">00359</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1MemImage.html">MemImage</a>: <span class="keyword">public</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a>
<a name="l00360"></a>00360 {
<a name="l00361"></a>00361 <span class="keyword">public</span>:
<a name="l00362"></a><a class="code" href="classisis_1_1data_1_1MemImage.html#7bcae94f698adcb22d4ec30b8075d40b">00362</a>     <a class="code" href="classisis_1_1data_1_1MemImage.html#7bcae94f698adcb22d4ec30b8075d40b">MemImage</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a> &amp;src ) {
<a name="l00363"></a>00363         <a class="code" href="classisis_1_1data_1_1MemImage.html#666be88cab66be91f0c9dee317c7c519">operator=</a>( src );
<a name="l00364"></a>00364     }
<a name="l00365"></a><a class="code" href="classisis_1_1data_1_1MemImage.html#666be88cab66be91f0c9dee317c7c519">00365</a>     <a class="code" href="classisis_1_1data_1_1MemImage.html">MemImage</a> &amp;<a class="code" href="classisis_1_1data_1_1MemImage.html#666be88cab66be91f0c9dee317c7c519">operator=</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1MemImage.html">MemImage</a> &amp;ref ) { <span class="comment">//use the copy for generic Images</span>
<a name="l00366"></a>00366         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1MemImage.html#666be88cab66be91f0c9dee317c7c519">operator=</a>( static_cast&lt;const Image &amp;&gt;( ref ) );
<a name="l00367"></a>00367     }
<a name="l00368"></a><a class="code" href="classisis_1_1data_1_1MemImage.html#734d63e8c8c9d1eec740522451662f7f">00368</a>     <a class="code" href="classisis_1_1data_1_1MemImage.html">MemImage</a> &amp;<a class="code" href="classisis_1_1data_1_1MemImage.html#666be88cab66be91f0c9dee317c7c519">operator=</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a> &amp;ref ) { <span class="comment">// copy the image, and make sure its of the given type</span>
<a name="l00369"></a>00369         <a class="code" href="classisis_1_1data_1_1Image.html#ae95616fad335432d8ce3b5e5daf004a" title="Copy operator.">Image::operator=</a>( ref ); <span class="comment">// ok we just copied the whole image</span>
<a name="l00370"></a>00370         <span class="comment">//we want deep copies of the chunks, and we want them to be of type T</span>
<a name="l00371"></a>00371         <span class="keyword">struct </span>: _internal::SortedChunkList::chunkPtrOperator {
<a name="l00372"></a>00372             std::pair&lt;util::TypeReference, util::TypeReference&gt; scale;
<a name="l00373"></a>00373             boost::shared_ptr&lt;Chunk&gt; operator()( <span class="keyword">const</span> boost::shared_ptr&lt; Chunk &gt;&amp; ptr ) {
<a name="l00374"></a>00374                 <span class="keywordflow">return</span> boost::shared_ptr&lt;Chunk&gt;( <span class="keyword">new</span> <a class="code" href="classisis_1_1data_1_1MemChunk.html" title="Chunk class for memory-based buffers.">MemChunk&lt;T&gt;</a>( *ptr, scale ) );
<a name="l00375"></a>00375             }
<a name="l00376"></a>00376         } conv_op;
<a name="l00377"></a>00377         conv_op.scale = ref.<a class="code" href="classisis_1_1data_1_1Image.html#789138e66345f3e5a73c65dbf05b2940" title="for each chunk get the scaling (and offset) which would be used in an conversion...">getScalingTo</a>( <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;T&gt;::staticID</a> );
<a name="l00378"></a>00378         <a class="code" href="log_8hpp.html#df04aa30f03b88d867f551c7d349f738">LOG</a>( <a class="code" href="namespaceisis_1_1data.html#1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="group__util.html#ggfe55030315ca143f9be26fd278df9f82d97a38c0fafe61d63fdb883c85d0067a">info</a> ) &lt;&lt; <span class="stringliteral">"Computed scaling for conversion from source image: ["</span> &lt;&lt; conv_op.scale &lt;&lt; <span class="stringliteral">"]"</span>;
<a name="l00379"></a>00379         <span class="keyword">set</span>.transform( conv_op );
<a name="l00380"></a>00380         <a class="code" href="classisis_1_1data_1_1Image.html#9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a> = <span class="keyword">set</span>.getLookup(); <span class="comment">// the lookup table still points to the old chunks</span>
<a name="l00381"></a>00381         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383 };
<a name="l00384"></a>00384 
<a name="l00385"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html">00385</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1TypedImage.html">TypedImage</a>: <span class="keyword">public</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a>
<a name="l00386"></a>00386 {
<a name="l00387"></a>00387 <span class="keyword">public</span>:
<a name="l00388"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#05f095de7c8b6146f067769591d7f0c5">00388</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html#05f095de7c8b6146f067769591d7f0c5">TypedImage</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a> &amp;src ): <a class="code" href="classisis_1_1data_1_1Image.html">Image</a>( src ) { <span class="comment">// ok we just copied the whole image</span>
<a name="l00389"></a>00389         <span class="comment">//but we want it to be of type T</span>
<a name="l00390"></a>00390         <a class="code" href="classisis_1_1data_1_1Image.html#ea5977c8de15ec5bc9f2e646ee48bca6" title="Ensure, the image has the type with the requested id.">makeOfTypeId</a>( <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;T&gt;::staticID</a> );
<a name="l00391"></a>00391     }
<a name="l00392"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#39da1b4e2f0785e43efa6a3a797e416b">00392</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html">TypedImage</a> &amp;<a class="code" href="classisis_1_1data_1_1TypedImage.html#39da1b4e2f0785e43efa6a3a797e416b">operator=</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html">TypedImage</a> &amp;ref ) { <span class="comment">//its already of the given type - so just copy it</span>
<a name="l00393"></a>00393         <a class="code" href="classisis_1_1data_1_1Image.html#ae95616fad335432d8ce3b5e5daf004a" title="Copy operator.">Image::operator=</a>( ref );
<a name="l00394"></a>00394         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00395"></a>00395     }
<a name="l00396"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#16654e67097e9e70a1bcc16b84bdd640">00396</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html">TypedImage</a> &amp;<a class="code" href="classisis_1_1data_1_1TypedImage.html#39da1b4e2f0785e43efa6a3a797e416b">operator=</a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html">Image</a> &amp;ref ) { <span class="comment">// copy the image, and make sure its of the given type</span>
<a name="l00397"></a>00397         <a class="code" href="classisis_1_1data_1_1Image.html#ae95616fad335432d8ce3b5e5daf004a" title="Copy operator.">Image::operator=</a>( ref );
<a name="l00398"></a>00398         <a class="code" href="classisis_1_1data_1_1Image.html#ea5977c8de15ec5bc9f2e646ee48bca6" title="Ensure, the image has the type with the requested id.">makeOfTypeId</a>( <a class="code" href="classisis_1_1data_1_1TypePtr.html" title="Generic class for type (and length) - aware pointers.">TypePtr&lt;T&gt;::staticID</a> );
<a name="l00399"></a>00399         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00400"></a>00400     }
<a name="l00401"></a>00401 };
<a name="l00402"></a>00402 
<a name="l00403"></a><a class="code" href="classisis_1_1data_1_1ImageList.html">00403</a> <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1ImageList.html">ImageList</a> : <span class="keyword">public</span> std::list&lt; boost::shared_ptr&lt;Image&gt; &gt;
<a name="l00404"></a>00404 {
<a name="l00405"></a>00405 <span class="keyword">public</span>:
<a name="l00406"></a>00406     <a class="code" href="classisis_1_1data_1_1ImageList.html#0bf8f489905b453e2687371e810e3317">ImageList</a>();
<a name="l00410"></a>00410     <a class="code" href="classisis_1_1data_1_1ImageList.html#0bf8f489905b453e2687371e810e3317">ImageList</a>( <a class="code" href="namespaceisis_1_1data.html#e7d0c035af83cf2a2824d5376559ff3c">ChunkList</a> src );
<a name="l00411"></a>00411 };
<a name="l00412"></a>00412 }
<a name="l00413"></a>00413 }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="preprocessor">#endif // IMAGE_H</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Dec 14 17:52:39 2010 for ISIS Core Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
