<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ISIS Core Library: /scr/tee1/isis/lib/Core/DataStorage/image.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ISIS Core Library&#160;<span id="projectnumber">0.7.2 (api 3.0.0)</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>/scr/tee1/isis/lib/Core/DataStorage/image.hpp</h1>  </div>
</div>
<div class="contents">
<a href="image_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">// C++ Interface: image</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// Description:</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//</span>
<a name="l00007"></a>00007 <span class="comment">// Author: Enrico Reimer&lt;reimer@cbs.mpg.de&gt;, (C) 2009</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">// Copyright: See COPYING file that comes with this distribution</span>
<a name="l00010"></a>00010 <span class="comment">//</span>
<a name="l00011"></a>00011 <span class="comment">//</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#ifndef IMAGE_H</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_H</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="chunk_8hpp.html">chunk.hpp</a>&quot;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;set&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;boost/shared_ptr.hpp&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;boost/foreach.hpp&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;boost/numeric/ublas/matrix.hpp&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;boost/numeric/ublas/io.hpp&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;boost/type_traits/remove_const.hpp&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;stack&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="sortedchunklist_8hpp.html">sortedchunklist.hpp</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="DataStorage_2common_8hpp.html">common.hpp</a>&quot;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="keyword">namespace </span>isis
<a name="l00030"></a>00030 {
<a name="l00031"></a>00031 <span class="keyword">namespace </span>data
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033 <span class="keyword">namespace </span>_internal
<a name="l00034"></a>00034 {
<a name="l00041"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html">00041</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> CHUNK_TYPE&gt; <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ImageIteratorTemplate</a>: <span class="keyword">public</span> std::iterator &lt;
<a name="l00042"></a>00042     std::random_access_iterator_tag,
<a name="l00043"></a>00043     typename boost::mpl::if_&lt;boost::is_const&lt;CHUNK_TYPE&gt;, typename CHUNK_TYPE::const_iterator, typename CHUNK_TYPE::iterator&gt;::type::value_type,
<a name="l00044"></a>00044     typename boost::mpl::if_&lt;boost::is_const&lt;CHUNK_TYPE&gt;, typename CHUNK_TYPE::const_iterator, typename CHUNK_TYPE::iterator&gt;::type::difference_type,
<a name="l00045"></a>00045     typename boost::mpl::if_&lt;boost::is_const&lt;CHUNK_TYPE&gt;, typename CHUNK_TYPE::const_iterator, typename CHUNK_TYPE::iterator&gt;::type::pointer,
<a name="l00046"></a>00046     typename boost::mpl::if_&lt;boost::is_const&lt;CHUNK_TYPE&gt;, typename CHUNK_TYPE::const_iterator, typename CHUNK_TYPE::iterator&gt;::type::reference
<a name="l00047"></a>00047     &gt;
<a name="l00048"></a>00048 {
<a name="l00049"></a>00049 <span class="keyword">protected</span>:
<a name="l00050"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a326fc32f7cca44a23c0369261430548c">00050</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> boost::mpl::if_&lt;boost::is_const&lt;CHUNK_TYPE&gt;, <span class="keyword">typename</span> CHUNK_TYPE::const_iterator, <span class="keyword">typename</span> CHUNK_TYPE::iterator&gt;::type <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a326fc32f7cca44a23c0369261430548c">inner_iterator</a>;
<a name="l00051"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a1117bab0659c1a5de4bfc480f9d8c097">00051</a>     <span class="keyword">typedef</span> CHUNK_TYPE <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a1117bab0659c1a5de4bfc480f9d8c097">chunk_type</a>;
<a name="l00052"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a7eddfba00eeb5f6de412367c0f109558">00052</a>     <span class="keyword">typedef</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ImageIteratorTemplate&lt;CHUNK_TYPE&gt;</a> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a7eddfba00eeb5f6de412367c0f109558">ThisType</a>;
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">00054</a>     std::vector&lt;chunk_type *&gt; <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>;
<a name="l00055"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">00055</a>     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a>;
<a name="l00056"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">00056</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a326fc32f7cca44a23c0369261430548c">inner_iterator</a> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a>;
<a name="l00057"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">00057</a>     <span class="keyword">typename</span> inner_iterator::difference_type <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a>;
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6ff7945957322e9016dc8ebc53df1b4b">00059</a>     <span class="keyword">typename</span> inner_iterator::difference_type <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6ff7945957322e9016dc8ebc53df1b4b">currentDist</a>()<span class="keyword"> const </span>{
<a name="l00060"></a>00060         <span class="keywordflow">if</span> ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> &gt;= <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>.size() )
<a name="l00061"></a>00061             <span class="keywordflow">return</span> 0; <span class="comment">// if we&#39;re behind the last chunk assume we are at the &quot;start&quot; of the &quot;end&quot;-chunk</span>
<a name="l00062"></a>00062         <span class="keywordflow">else</span> {
<a name="l00063"></a>00063             <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a326fc32f7cca44a23c0369261430548c">inner_iterator</a> chit_begin = <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>[<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a>]-&gt;begin(); <span class="comment">// cast in a const or cast out a non existing one</span>
<a name="l00064"></a>00064             <span class="keywordflow">return</span> std::distance ( chit_begin, <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> ); <span class="comment">// so we use same iterators here</span>
<a name="l00065"></a>00065         }
<a name="l00066"></a>00066     }
<a name="l00067"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ae62de58210c88c70d681d9bee7c419ad">00067</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ImageIteratorTemplate</a>&lt;const CHUNK_TYPE&gt;; <span class="comment">//yes, I&#39;m my own friend, sometimes :-) (enables the constructor below)</span>
<a name="l00068"></a>00068 <span class="keyword">public</span>:
<a name="l00069"></a>00069 
<a name="l00070"></a>00070     <span class="comment">//will become additional constructor from non const if this is const, otherwise overrride the default copy contructor</span>
<a name="l00071"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ad6ab1d303e263ec4b6b4ed08d9fcc24e">00071</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ae5fc8ce70b9ebe8a21b4b34fb026f1b0">ImageIteratorTemplate</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ImageIteratorTemplate</a>&lt;<span class="keyword">typename</span> boost::remove_const&lt;CHUNK_TYPE&gt;::type &gt; &amp;src ) :
<a name="l00072"></a>00072         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a> ( src.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>.begin(), src.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>.end() ), <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> ( src.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> ),
<a name="l00073"></a>00073         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> ( src.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> ),
<a name="l00074"></a>00074         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a> ( src.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a> )
<a name="l00075"></a>00075     {}
<a name="l00076"></a>00076 
<a name="l00077"></a>00077     <span class="comment">// empty constructor</span>
<a name="l00078"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ae5fc8ce70b9ebe8a21b4b34fb026f1b0">00078</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ae5fc8ce70b9ebe8a21b4b34fb026f1b0">ImageIteratorTemplate</a>() : <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> ( 0 ), <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a> ( 0 ) {}
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="comment">// normal conytructor</span>
<a name="l00082"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a739bab12d1fc1b80985a146ccb71fe25">00082</a>     <span class="keyword">explicit</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ae5fc8ce70b9ebe8a21b4b34fb026f1b0">ImageIteratorTemplate</a> ( <span class="keyword">const</span> std::vector&lt;chunk_type *&gt;&amp; _chunks ) :
<a name="l00083"></a>00083         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a> ( _chunks ), <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> ( 0 ),
<a name="l00084"></a>00084         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>[0]-&gt;begin() ),
<a name="l00085"></a>00085         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a> ( std::distance ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a>, <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>[0]-&gt;end() ) )
<a name="l00086"></a>00086     {}
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaaa87cd110f236f75bace97c04a60e20">00088</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaaa87cd110f236f75bace97c04a60e20">operator++</a>() {
<a name="l00089"></a>00089         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#abac0c06882a51cc277837486cb7e0397">operator+= </a>( 1 );
<a name="l00090"></a>00090     }
<a name="l00091"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3b9e20b45b6641ce106fd725f6e2251f">00091</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3b9e20b45b6641ce106fd725f6e2251f">operator--</a>() {
<a name="l00092"></a>00092         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ace836ca3b19ecdf83d1c3af6d44e6303">operator-= </a>( 1 );
<a name="l00093"></a>00093     }
<a name="l00094"></a>00094 
<a name="l00095"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a4ffdd5c09e9fe8ffe650ab8060526311">00095</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaaa87cd110f236f75bace97c04a60e20">operator++ </a>( <span class="keywordtype">int</span> ) {
<a name="l00096"></a>00096         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> tmp = *<span class="keyword">this</span>;
<a name="l00097"></a>00097         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaaa87cd110f236f75bace97c04a60e20">operator++</a>();
<a name="l00098"></a>00098         <span class="keywordflow">return</span> tmp;
<a name="l00099"></a>00099     }
<a name="l00100"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a108c3002f746554b6d7bb5f380352f0a">00100</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3b9e20b45b6641ce106fd725f6e2251f">operator-- </a>( <span class="keywordtype">int</span> ) {
<a name="l00101"></a>00101         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> tmp = *<span class="keyword">this</span>;
<a name="l00102"></a>00102         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3b9e20b45b6641ce106fd725f6e2251f">operator--</a>();
<a name="l00103"></a>00103         <span class="keywordflow">return</span> tmp;
<a name="l00104"></a>00104     }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a5834592f5c356c2bde0d14dd751d4bb4">00106</a>     <span class="keyword">typename</span> inner_iterator::reference <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a5834592f5c356c2bde0d14dd751d4bb4">operator*</a>()<span class="keyword"> const </span>{
<a name="l00107"></a>00107         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a>.operator * ();
<a name="l00108"></a>00108     }
<a name="l00109"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a757b430421ae4119597e94a3b695bb6e">00109</a>     <span class="keyword">typename</span> inner_iterator::pointer  <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a757b430421ae4119597e94a3b695bb6e">operator-&gt;</a>()<span class="keyword"> const </span>{
<a name="l00110"></a>00110         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a>.operator-&gt;();
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac5955bec92bce2d749af5672e2830a6e">00113</a>     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac5955bec92bce2d749af5672e2830a6e">operator== </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;cmp )<span class="keyword"> const </span>{
<a name="l00114"></a>00114         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> == cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> &amp;&amp; <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> == cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a>;
<a name="l00115"></a>00115     }
<a name="l00116"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ade54ec06c8e6cef9dbb0b0937d4ca120">00116</a>     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ade54ec06c8e6cef9dbb0b0937d4ca120">operator!= </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;cmp )<span class="keyword"> const </span>{
<a name="l00117"></a>00117         <span class="keywordflow">return</span> !<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac5955bec92bce2d749af5672e2830a6e">operator== </a>( cmp );
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119 
<a name="l00120"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ad3df6438690f668b1f58436d31c40862">00120</a>     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ad3df6438690f668b1f58436d31c40862">operator&gt; </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;cmp )<span class="keyword"> const </span>{
<a name="l00121"></a>00121         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> &gt; cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> || ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> == cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> &amp;&amp; <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> &gt; cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> );
<a name="l00122"></a>00122     }
<a name="l00123"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a692c47625e313d983f82de737df40aa5">00123</a>     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a692c47625e313d983f82de737df40aa5">operator&lt; </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;cmp )<span class="keyword"> const </span>{
<a name="l00124"></a>00124         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> &lt; cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> || ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> == cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> &amp;&amp; <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> &lt; cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> );
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a608e0d6ad0a24818fb677b8548339e1b">00128</a>     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a608e0d6ad0a24818fb677b8548339e1b">operator&gt;= </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;cmp )<span class="keyword"> const </span>{
<a name="l00129"></a>00129         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ad3df6438690f668b1f58436d31c40862">operator&gt; </a>( cmp ) || <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac5955bec92bce2d749af5672e2830a6e">operator== </a>( cmp );
<a name="l00130"></a>00130     }
<a name="l00131"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a4538618a31d59422821b4b42845e0820">00131</a>     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a4538618a31d59422821b4b42845e0820">operator&lt;= </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;cmp )<span class="keyword"> const </span>{
<a name="l00132"></a>00132         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a692c47625e313d983f82de737df40aa5">operator&lt; </a>( cmp ) || <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac5955bec92bce2d749af5672e2830a6e">operator== </a>( cmp );
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a7d7a22f35596bf943f56761391312dd3">00135</a>     <span class="keyword">typename</span> inner_iterator::difference_type <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a7d7a22f35596bf943f56761391312dd3">operator- </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;cmp )<span class="keyword"> const </span>{
<a name="l00136"></a>00136         <span class="keyword">typename</span> inner_iterator::difference_type dist = ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> - cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> ) * <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a>; <span class="comment">// get the (virtual) distance from my current block to cmp&#39;s current block</span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <span class="keywordflow">if</span> ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> &gt;= cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> ) { <span class="comment">//if I&#39;m beyond cmp add my current pos to the distance, and substract his</span>
<a name="l00139"></a>00139             dist += <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6ff7945957322e9016dc8ebc53df1b4b">currentDist</a>() - cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6ff7945957322e9016dc8ebc53df1b4b">currentDist</a>();
<a name="l00140"></a>00140         } <span class="keywordflow">else</span> {
<a name="l00141"></a>00141             dist += cmp.<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6ff7945957322e9016dc8ebc53df1b4b">currentDist</a>() - <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6ff7945957322e9016dc8ebc53df1b4b">currentDist</a>();
<a name="l00142"></a>00142         }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144         <span class="keywordflow">return</span> dist;
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146 
<a name="l00147"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6a9b1561934832b81591ae5846791d10">00147</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6a9b1561934832b81591ae5846791d10">operator+ </a>( <span class="keyword">typename</span> ThisType::difference_type n )<span class="keyword"> const </span>{
<a name="l00148"></a>00148         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a7eddfba00eeb5f6de412367c0f109558">ThisType</a> ( *<span class="keyword">this</span> ) += n;
<a name="l00149"></a>00149     }
<a name="l00150"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#acf42ef9dc6199dff76f9f9f5660b447b">00150</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a7d7a22f35596bf943f56761391312dd3">operator- </a>( <span class="keyword">typename</span> ThisType::difference_type n )<span class="keyword"> const </span>{
<a name="l00151"></a>00151         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a7eddfba00eeb5f6de412367c0f109558">ThisType</a> ( *<span class="keyword">this</span> ) -= n;
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 
<a name="l00154"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#abac0c06882a51cc277837486cb7e0397">00154</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#abac0c06882a51cc277837486cb7e0397">operator+= </a>( <span class="keyword">typename</span> inner_iterator::difference_type n ) {
<a name="l00155"></a>00155         n += <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a6ff7945957322e9016dc8ebc53df1b4b">currentDist</a>(); <span class="comment">//start from current begin (add current_it-(begin of the current chunk) to n)</span>
<a name="l00156"></a>00156         assert ( ( n / <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a> + static_cast&lt;typename ThisType::difference_type&gt; ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> ) ) &gt;= 0 );
<a name="l00157"></a>00157         <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> += n / <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a>; <span class="comment">//if neccesary jump to next chunk</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <span class="keywordflow">if</span> ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a> &lt; <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>.size() )
<a name="l00160"></a>00160             <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> = <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>[<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ac471f08ee28b9fec7fe93cbaade80936">ch_idx</a>]-&gt;begin() + n % <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#aaf24ef7d3e9b354693a1eb6455ccccc5">ch_len</a>; <span class="comment">//set new current iterator in new chunk plus the &quot;rest&quot;</span>
<a name="l00161"></a>00161         <span class="keywordflow">else</span>
<a name="l00162"></a>00162             <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a919a86261086ae0a8ec43fb3526a6d84">current_it</a> = ( * ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a>.end() - 1 ) )-&gt;end() ; <span class="comment">//set current_it to the last chunks end iterator if we are behind it</span>
<a name="l00163"></a>00163 
<a name="l00164"></a>00164         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00165"></a>00165     }
<a name="l00166"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ace836ca3b19ecdf83d1c3af6d44e6303">00166</a>     <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">ThisType</a> &amp;<a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ace836ca3b19ecdf83d1c3af6d44e6303">operator-= </a>( <span class="keyword">typename</span> inner_iterator::difference_type n ) {
<a name="l00167"></a>00167         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#abac0c06882a51cc277837486cb7e0397">operator+= </a>( -n );
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ab67fb2e8c137a3f421ba6f0391da9798">00170</a>     <span class="keyword">typename</span> ThisType::reference <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#ab67fb2e8c137a3f421ba6f0391da9798">operator[] </a>( <span class="keyword">typename</span> inner_iterator::difference_type n )<span class="keyword"> const </span>{
<a name="l00171"></a>00171         <span class="keywordflow">return</span> * ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a7eddfba00eeb5f6de412367c0f109558">ThisType</a> ( <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html#a3d87e16f9a0ddc6ab73b2b06a8b1344c">chunks</a> ) += n );
<a name="l00172"></a>00172     }
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 };
<a name="l00175"></a>00175 }
<a name="l00176"></a>00176 
<a name="l00178"></a><a class="code" href="classisis_1_1data_1_1ChunkOp.html">00178</a> <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1ChunkOp.html" title="Base class for operators used for foreachChunk.">ChunkOp</a> : std::unary_function&lt;Chunk &amp;, bool&gt;
<a name="l00179"></a>00179 {
<a name="l00180"></a>00180 <span class="keyword">public</span>:
<a name="l00181"></a>00181     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1ChunkOp.html#ab1fae7b38670d42cd15b7e0355725aea">operator() </a>( <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> &amp;, <a class="code" href="classisis_1_1util_1_1vector4.html">util::vector4&lt;size_t&gt;</a> posInImage ) = 0;
<a name="l00182"></a>00182     <span class="keyword">virtual</span> <a class="code" href="classisis_1_1data_1_1ChunkOp.html#a9ecfcc2d9c70c41ed93ab0f5b1f7f493">~ChunkOp</a>();
<a name="l00183"></a>00183 };
<a name="l00184"></a>00184 
<a name="l00186"></a><a class="code" href="classisis_1_1data_1_1Image.html">00186</a> <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a>:
<a name="l00187"></a>00187     <span class="keyword">public</span> _internal::NDimensional&lt;4&gt;,
<a name="l00188"></a>00188     <span class="keyword">public</span> util::PropertyMap
<a name="l00189"></a>00189 {
<a name="l00190"></a>00190     <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3">dimensions</a> minIndexingDim;
<a name="l00191"></a>00191 <span class="keyword">public</span>:
<a name="l00201"></a>00201     <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1Image.html#a7f573a7b5d73ba8abcadb337e43f73bc" title="Enforce indexing to start at a given dimension.">setIndexingDim</a> ( <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3">dimensions</a> d = <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3a9f473e3b41b1b75c9c3f0428c2712178">rowDim</a> );
<a name="l00202"></a><a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633a0d4cbf4f6526d1d6895c71e6bea6542c">00202</a>     <span class="keyword">enum</span> <a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633">orientation</a> {<a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633aee38808f2b23291db3fbb0aebe7ba405">axial</a>, <a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633a64a137c1013ea7f831d25c8701c0693d">reversed_axial</a>, <a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633a0d4cbf4f6526d1d6895c71e6bea6542c">sagittal</a>, <a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633a3adbf32c9b5579e6e97586301f48e047">reversed_sagittal</a>, <a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633ad77b748bff3861529f19469104a94e6c">coronal</a>, <a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633af6335ced67866cc519e297f42ee64caa">reversed_coronal</a>};
<a name="l00203"></a>00203 
<a name="l00204"></a><a class="code" href="classisis_1_1data_1_1Image.html#a76dc53ed34c1c73d797f50ef182d7f4a">00204</a>     <span class="keyword">typedef</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">_internal::ImageIteratorTemplate&lt;Chunk&gt;</a> <a class="code" href="classisis_1_1data_1_1Image.html#a76dc53ed34c1c73d797f50ef182d7f4a">iterator</a>;
<a name="l00205"></a><a class="code" href="classisis_1_1data_1_1Image.html#a21407a9c75b9ea3f50e52664d4f7a19e">00205</a>     <span class="keyword">typedef</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">_internal::ImageIteratorTemplate&lt;const Chunk&gt;</a> <a class="code" href="classisis_1_1data_1_1Image.html#a21407a9c75b9ea3f50e52664d4f7a19e">const_iterator</a>;
<a name="l00206"></a><a class="code" href="classisis_1_1data_1_1Image.html#a4cb25846b5e8e6539e710416b81d4e61">00206</a>     <span class="keyword">typedef</span> iterator::reference <a class="code" href="classisis_1_1data_1_1Image.html#a4cb25846b5e8e6539e710416b81d4e61">reference</a>;
<a name="l00207"></a><a class="code" href="classisis_1_1data_1_1Image.html#aaaebaaac8caa5b11a0d81c6a286c55e4">00207</a>     <span class="keyword">typedef</span> const_iterator::reference <a class="code" href="classisis_1_1data_1_1Image.html#aaaebaaac8caa5b11a0d81c6a286c55e4">const_reference</a>;
<a name="l00208"></a><a class="code" href="classisis_1_1data_1_1Image.html#ad0eb63ce20448f5739077619951b5290">00208</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classisis_1_1data_1_1Image.html#ad0eb63ce20448f5739077619951b5290">neededProperties</a>;
<a name="l00209"></a>00209 <span class="keyword">protected</span>:
<a name="l00210"></a><a class="code" href="classisis_1_1data_1_1Image.html#af3656b415fa1872a8da29f82cb98ed6e">00210</a>     _internal::SortedChunkList <span class="keyword">set</span>;
<a name="l00211"></a><a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">00211</a>     std::vector&lt;boost::shared_ptr&lt;Chunk&gt; &gt; <a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a>;
<a name="l00212"></a>00212 <span class="keyword">private</span>:
<a name="l00213"></a>00213     <span class="keywordtype">size_t</span> chunkVolume;
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="keywordtype">void</span> deduplicateProperties();
<a name="l00216"></a>00216 
<a name="l00222"></a>00222     <span class="keyword">const</span> boost::shared_ptr&lt;Chunk&gt; &amp;chunkPtrAt ( <span class="keywordtype">size_t</span> at ) <span class="keyword">const</span>;
<a name="l00223"></a>00223 
<a name="l00235"></a>00235     <span class="keyword">inline</span> std::pair&lt;size_t, size_t&gt; commonGet ( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second, <span class="keywordtype">size_t</span> third, <span class="keywordtype">size_t</span> fourth )<span class="keyword"> const </span>{
<a name="l00236"></a>00236         <span class="keyword">const</span> <span class="keywordtype">size_t</span> idx[] = {first, second, third, fourth};
<a name="l00237"></a>00237         <a class="code" href="log_8hpp.html#a977f6c27373576d6ffe1523fc2afb8b6">LOG_IF</a> ( ! <a class="code" href="classisis_1_1data_1_1Image.html#a07dfbac4eb23def6dd10ab2182d98eeb">clean</a>, <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">error</a> )
<a name="l00238"></a>00238                 &lt;&lt; <span class="stringliteral">&quot;Getting data from a non indexed image will result in undefined behavior. Run reIndex first.&quot;</span>;
<a name="l00239"></a>00239         <a class="code" href="log_8hpp.html#a977f6c27373576d6ffe1523fc2afb8b6">LOG_IF</a> ( <span class="keyword">set</span>.<a class="code" href="classisis_1_1data_1_1Image.html#a9fb0c9f8351fddc6a2fea609d487aa2b">isEmpty</a>(), <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">error</a> )
<a name="l00240"></a>00240                 &lt;&lt; <span class="stringliteral">&quot;Getting data from a empty image will result in undefined behavior.&quot;</span>;
<a name="l00241"></a>00241         <a class="code" href="log_8hpp.html#a977f6c27373576d6ffe1523fc2afb8b6">LOG_IF</a> ( !<a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#a25357b6c09d29da78456e2c2504d479e" title="Check if index fits into the dimensional size of the object.">isInRange</a> ( idx ), <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">isis::error</a> )
<a name="l00242"></a>00242                 &lt;&lt; <span class="stringliteral">&quot;Index &quot;</span> &lt;&lt; <a class="code" href="classisis_1_1util_1_1vector4.html">util::vector4&lt;size_t&gt;</a> ( idx ) &lt;&lt; <span class="stringliteral">&quot; is out of range (&quot;</span> &lt;&lt; <a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#a5987df3c819b04abd031e0049a87f3e7" title="generates a string representing the size">getSizeAsString</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;
<a name="l00243"></a>00243         <span class="keyword">const</span> <span class="keywordtype">size_t</span> index = <a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#ada01b000f0bccc84df97c149b4b827e0" title="Compute linear index from n-dimensional index,.">getLinearIndex</a> ( idx );
<a name="l00244"></a>00244         <span class="keywordflow">return</span> std::make_pair ( index / chunkVolume, index % chunkVolume );
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="keyword">protected</span>:
<a name="l00249"></a><a class="code" href="classisis_1_1data_1_1Image.html#a07dfbac4eb23def6dd10ab2182d98eeb">00249</a>     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#a07dfbac4eb23def6dd10ab2182d98eeb">clean</a>;
<a name="l00250"></a><a class="code" href="classisis_1_1data_1_1Image.html#a4f9d2bc9fbdf23436f89973898c5cfe4">00250</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classisis_1_1data_1_1Image.html#a4f9d2bc9fbdf23436f89973898c5cfe4">defaultChunkEqualitySet</a>;
<a name="l00251"></a>00251 
<a name="l00270"></a>00270     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#aece4ae886cea93d0e05087c9b3e2c85b" title="Search for a dimensional break in all stored chunks.">getChunkStride</a> ( <span class="keywordtype">size_t</span> base_stride = 1 );
<a name="l00276"></a>00276     <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> &amp;<a class="code" href="classisis_1_1data_1_1Image.html#a087ed8c4884cea467e47c386c65d5be2" title="Access a chunk via index (and the lookup table) The Chunk will only have metadata which are unique to...">chunkAt</a> ( <span class="keywordtype">size_t</span> at );
<a name="l00278"></a>00278     <a class="code" href="classisis_1_1data_1_1Image.html#afe4f8006b3f04f60f68b5027ed8bbebc" title="Creates an empty Image object.">Image</a>();
<a name="l00279"></a>00279 
<a name="l00280"></a><a class="code" href="classisis_1_1data_1_1Image.html#a94c5a4dae0eb700c87401ea6eac87c40">00280</a>     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#a94c5a4dae0eb700c87401ea6eac87c40">m_RowVec</a>;
<a name="l00281"></a><a class="code" href="classisis_1_1data_1_1Image.html#a7c8dfbee9badb073f6096ba8e21475af">00281</a>     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#a7c8dfbee9badb073f6096ba8e21475af">m_RowVecInv</a>;
<a name="l00282"></a><a class="code" href="classisis_1_1data_1_1Image.html#a409a8858502576ece0e23851306294f6">00282</a>     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#a409a8858502576ece0e23851306294f6">m_ColumnVec</a>;
<a name="l00283"></a><a class="code" href="classisis_1_1data_1_1Image.html#ae29cf093eaec130b17a464c8adf9f0fc">00283</a>     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#ae29cf093eaec130b17a464c8adf9f0fc">m_ColumnVecInv</a>;
<a name="l00284"></a><a class="code" href="classisis_1_1data_1_1Image.html#a6512a575ed4322de1a439944773fafb0">00284</a>     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#a6512a575ed4322de1a439944773fafb0">m_SliceVec</a>;
<a name="l00285"></a><a class="code" href="classisis_1_1data_1_1Image.html#a080d2483667cd366d95aaf64276a9c1d">00285</a>     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#a080d2483667cd366d95aaf64276a9c1d">m_SliceVecInv</a>;
<a name="l00286"></a><a class="code" href="classisis_1_1data_1_1Image.html#aa48ea22c820fcb5748582c42167f47b6">00286</a>     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#aa48ea22c820fcb5748582c42167f47b6">m_Offset</a>;
<a name="l00287"></a>00287 
<a name="l00288"></a>00288 <span class="keyword">public</span>:
<a name="l00293"></a>00293     <a class="code" href="classisis_1_1data_1_1Image.html#afe4f8006b3f04f60f68b5027ed8bbebc" title="Creates an empty Image object.">Image</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> &amp;ref );
<a name="l00294"></a>00294 
<a name="l00299"></a><a class="code" href="classisis_1_1data_1_1Image.html#ac8448f89faef184720e5ae079873c7ee">00299</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classisis_1_1data_1_1Image.html#afe4f8006b3f04f60f68b5027ed8bbebc" title="Creates an empty Image object.">Image</a> ( std::list&lt;T&gt; &amp;chunks, <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3">dimensions</a> min_dim = <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3a9f473e3b41b1b75c9c3f0428c2712178">rowDim</a> ) :
<a name="l00300"></a>00300         _internal::<a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#a3176ed9830494aed59c944eef256bf1b">NDimensional</a>&lt;4&gt;(), util::<a class="code" href="classisis_1_1util_1_1PropertyMap.html#afcc2f4657fbd500284e60e0ef442bbe6">PropertyMap</a>(), minIndexingDim ( min_dim ),
<a name="l00301"></a>00301         <a class="code" href="classisis_1_1data_1_1Image.html#af3656b415fa1872a8da29f82cb98ed6e">set</a> ( <a class="code" href="classisis_1_1data_1_1Image.html#a4f9d2bc9fbdf23436f89973898c5cfe4">defaultChunkEqualitySet</a> ),
<a name="l00302"></a>00302         <a class="code" href="classisis_1_1data_1_1Image.html#a07dfbac4eb23def6dd10ab2182d98eeb">clean</a> ( false ) {
<a name="l00303"></a>00303         util::Singletons::get&lt;NeededsList&lt;Image&gt;, 0&gt;().applyTo( *<span class="keyword">this</span> );
<a name="l00304"></a>00304         <span class="keyword">set</span>.addSecondarySort ( <span class="stringliteral">&quot;acquisitionNumber&quot;</span> );
<a name="l00305"></a>00305         <a class="code" href="classisis_1_1data_1_1Image.html#ae94b9bb6689b5caae2e0885d71ffad83" title="Insert Chunks or objects with the base Chunk from a sequence container into the Image.">insertChunksFromList</a> ( chunks );
<a name="l00306"></a>00306     }
<a name="l00311"></a><a class="code" href="classisis_1_1data_1_1Image.html#af9539532e4fb1458c559f13a6b770174">00311</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classisis_1_1data_1_1Image.html#afe4f8006b3f04f60f68b5027ed8bbebc" title="Creates an empty Image object.">Image</a> ( std::vector&lt;T&gt; &amp;chunks, <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3">dimensions</a> min_dim = <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3a9f473e3b41b1b75c9c3f0428c2712178">rowDim</a> ) :
<a name="l00312"></a>00312         _internal::<a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#a3176ed9830494aed59c944eef256bf1b">NDimensional</a>&lt;4&gt;(), util::<a class="code" href="classisis_1_1util_1_1PropertyMap.html#afcc2f4657fbd500284e60e0ef442bbe6">PropertyMap</a>(), minIndexingDim ( min_dim ),
<a name="l00313"></a>00313         <a class="code" href="classisis_1_1data_1_1Image.html#af3656b415fa1872a8da29f82cb98ed6e">set</a> ( <a class="code" href="classisis_1_1data_1_1Image.html#a4f9d2bc9fbdf23436f89973898c5cfe4">defaultChunkEqualitySet</a> ),
<a name="l00314"></a>00314         <a class="code" href="classisis_1_1data_1_1Image.html#a07dfbac4eb23def6dd10ab2182d98eeb">clean</a> ( false ) {
<a name="l00315"></a>00315         util::Singletons::get&lt;NeededsList&lt;Image&gt;, 0&gt;().applyTo( *<span class="keyword">this</span> );
<a name="l00316"></a>00316         <span class="keyword">set</span>.addSecondarySort ( <span class="stringliteral">&quot;acquisitionNumber&quot;</span> );
<a name="l00317"></a>00317         std::list&lt;T&gt; tmp( chunks.begin(), chunks.end() );
<a name="l00318"></a>00318         <a class="code" href="classisis_1_1data_1_1Image.html#ae94b9bb6689b5caae2e0885d71ffad83" title="Insert Chunks or objects with the base Chunk from a sequence container into the Image.">insertChunksFromList</a> ( tmp );
<a name="l00319"></a>00319         chunks.assign( tmp.begin(), tmp.end() );
<a name="l00320"></a>00320     }
<a name="l00321"></a>00321 
<a name="l00327"></a><a class="code" href="classisis_1_1data_1_1Image.html#ae94b9bb6689b5caae2e0885d71ffad83">00327</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#ae94b9bb6689b5caae2e0885d71ffad83" title="Insert Chunks or objects with the base Chunk from a sequence container into the Image.">insertChunksFromList</a> ( std::list&lt;T&gt; &amp;chunks ) {
<a name="l00328"></a>00328         BOOST_MPL_ASSERT ( ( boost::is_base_of&lt;Chunk, T&gt; ) );
<a name="l00329"></a>00329         <span class="keywordtype">size_t</span> cnt = 0;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331         <span class="keywordflow">for</span> ( <span class="keyword">typename</span> std::list&lt;T&gt;::iterator i = chunks.begin(); i != chunks.end(); ) { <span class="comment">// for all remaining chunks</span>
<a name="l00332"></a>00332             <span class="keywordflow">if</span> ( <a class="code" href="classisis_1_1data_1_1Image.html#a14a33c4d2ba857b38c2188fb8e8abfd9" title="Insert a Chunk into the Image.">insertChunk</a> ( *i ) ) {
<a name="l00333"></a>00333                 chunks.erase ( i++ );
<a name="l00334"></a>00334                 cnt++;
<a name="l00335"></a>00335             } <span class="keywordflow">else</span> {
<a name="l00336"></a>00336                 i++;
<a name="l00337"></a>00337             }
<a name="l00338"></a>00338         }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340         <span class="keywordflow">if</span> ( ! <a class="code" href="classisis_1_1data_1_1Image.html#a9fb0c9f8351fddc6a2fea609d487aa2b">isEmpty</a>() ) {
<a name="l00341"></a>00341             <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82ad97a38c0fafe61d63fdb883c85d0067a">info</a> ) &lt;&lt; <span class="stringliteral">&quot;Reindexing image with &quot;</span> &lt;&lt; cnt &lt;&lt; <span class="stringliteral">&quot; chunks.&quot;</span>;
<a name="l00342"></a>00342 
<a name="l00343"></a>00343             <span class="keywordflow">if</span> ( !<a class="code" href="classisis_1_1data_1_1Image.html#a801a02eb15ae94b384aaa97061e2ad1c" title="(Re)computes the image layout and metadata.">reIndex</a>() ) {
<a name="l00344"></a>00344                 <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a15b301b1e8962fdf9562e683d7be5d9f">Runtime</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">error</a> ) &lt;&lt; <span class="stringliteral">&quot;Failed to create image from &quot;</span> &lt;&lt; cnt &lt;&lt; <span class="stringliteral">&quot; chunks.&quot;</span>;
<a name="l00345"></a>00345             } <span class="keywordflow">else</span> {
<a name="l00346"></a>00346                 <a class="code" href="log_8hpp.html#a977f6c27373576d6ffe1523fc2afb8b6">LOG_IF</a> ( !<a class="code" href="classisis_1_1util_1_1PropertyMap.html#ad84de96685231d402bf9e8741a72db91" title="Get a list of missing properties.">getMissing</a>().empty(), <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a5e3b72b2efcd89afa9487c776fb12d19">warning</a> )
<a name="l00347"></a>00347                         &lt;&lt; <span class="stringliteral">&quot;The created image is missing some properties: &quot;</span> &lt;&lt; <a class="code" href="classisis_1_1util_1_1PropertyMap.html#ad84de96685231d402bf9e8741a72db91" title="Get a list of missing properties.">getMissing</a>() &lt;&lt; <span class="stringliteral">&quot;. It will be invalid.&quot;</span>;
<a name="l00348"></a>00348             }
<a name="l00349"></a>00349         } <span class="keywordflow">else</span> {
<a name="l00350"></a>00350             <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a5e3b72b2efcd89afa9487c776fb12d19">warning</a> ) &lt;&lt; <span class="stringliteral">&quot;Image is empty after inserting chunks.&quot;</span>;
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353         <span class="keywordflow">return</span> cnt;
<a name="l00354"></a>00354     }
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 
<a name="l00360"></a>00360     <a class="code" href="classisis_1_1data_1_1Image.html#afe4f8006b3f04f60f68b5027ed8bbebc" title="Creates an empty Image object.">Image</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> &amp;chunk, <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3">dimensions</a> min_dim = <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3a9f473e3b41b1b75c9c3f0428c2712178">rowDim</a> );
<a name="l00361"></a>00361 
<a name="l00366"></a>00366     <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> &amp;<a class="code" href="classisis_1_1data_1_1Image.html#aae95616fad335432d8ce3b5e5daf004a" title="Copy operator.">operator= </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> &amp;ref );
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#acd213fa6d0856d45e6413801f9bdec66">checkMakeClean</a>();
<a name="l00369"></a>00369     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#a102fa197eedd6a7cc8642254be953656">isClean</a>() <span class="keyword">const</span>;
<a name="l00387"></a><a class="code" href="classisis_1_1data_1_1Image.html#a31aecea5e2a012d677c59222ebe13198">00387</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; T &amp;<a class="code" href="classisis_1_1data_1_1Image.html#a31aecea5e2a012d677c59222ebe13198" title="This method returns a reference to the voxel value at the given coordinates.">voxel</a> ( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0 ) {
<a name="l00388"></a>00388         <a class="code" href="classisis_1_1data_1_1Image.html#acd213fa6d0856d45e6413801f9bdec66">checkMakeClean</a>();
<a name="l00389"></a>00389         <span class="keyword">const</span> std::pair&lt;size_t, size_t&gt; index = commonGet ( first, second, third, fourth );
<a name="l00390"></a>00390         <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;T&gt;</a> &amp;data = <a class="code" href="classisis_1_1data_1_1Image.html#a087ed8c4884cea467e47c386c65d5be2" title="Access a chunk via index (and the lookup table) The Chunk will only have metadata which are unique to...">chunkAt</a> ( index.first ).<a class="code" href="classisis_1_1data_1_1Chunk.html#a210dafafa0c52951d6b15568d797447b">asValueArray</a>&lt;T&gt;();
<a name="l00391"></a>00391         <span class="keywordflow">return</span> data[index.second];
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393 
<a name="l00406"></a><a class="code" href="classisis_1_1data_1_1Image.html#a907da37c72907fa34c67ed937a34c83a">00406</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">const</span> T &amp;<a class="code" href="classisis_1_1data_1_1Image.html#a907da37c72907fa34c67ed937a34c83a" title="Get a const reference to the voxel value at the given coordinates.">voxel</a> ( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0 )<span class="keyword"> const </span>{
<a name="l00407"></a>00407         <span class="keyword">const</span> std::pair&lt;size_t, size_t&gt; index = commonGet ( first, second, third, fourth );
<a name="l00408"></a>00408         <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;T&gt;</a> &amp;data = chunkPtrAt ( index.first )-&gt;getValueArray&lt;T&gt;();
<a name="l00409"></a>00409         <span class="keywordflow">return</span> data[index.second];
<a name="l00410"></a>00410     }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="keyword">const</span> <a class="code" href="classisis_1_1util_1_1__internal_1_1GenericReference.html" title="Base class to store and handle references to Value and ValueArray objects.">util::ValueReference</a> <a class="code" href="classisis_1_1data_1_1Image.html#ab07f75534c9edeab26dc46c68c99771a">getVoxelValue</a> ( <span class="keywordtype">size_t</span> nrOfColumns, <span class="keywordtype">size_t</span> nrOfRows = 0, <span class="keywordtype">size_t</span> nrOfSlices = 0, <span class="keywordtype">size_t</span> nrOfTimesteps = 0 ) <span class="keyword">const</span>;
<a name="l00413"></a>00413     <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1Image.html#af99841f335c21d3061b17e4b99c2ef6d">setVoxelValue</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1util_1_1__internal_1_1GenericReference.html" title="Base class to store and handle references to Value and ValueArray objects.">util::ValueReference</a> &amp;val, <span class="keywordtype">size_t</span> nrOfColumns, <span class="keywordtype">size_t</span> nrOfRows = 0, <span class="keywordtype">size_t</span> nrOfSlices = 0, <span class="keywordtype">size_t</span> nrOfTimesteps = 0 );
<a name="l00414"></a>00414 
<a name="l00425"></a>00425     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classisis_1_1data_1_1Image.html#a601eaac6eedf7eaf6fdb6c31b1e8765d" title="Get the type of the chunk with &amp;quot;biggest&amp;quot; type.">getMajorTypeID</a>() <span class="keyword">const</span>;
<a name="l00427"></a>00427     std::string <a class="code" href="classisis_1_1data_1_1Image.html#a6d5302c9e0de9fe8c97fbafa4a9e2d1e">getMajorTypeName</a>() <span class="keyword">const</span>;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     <a class="code" href="classisis_1_1data_1_1Image.html#a76dc53ed34c1c73d797f50ef182d7f4a">iterator</a> <a class="code" href="classisis_1_1data_1_1Image.html#abf0729737cf6906a0aa6c1e830c0d728">begin</a>();
<a name="l00430"></a>00430     <a class="code" href="classisis_1_1data_1_1Image.html#a76dc53ed34c1c73d797f50ef182d7f4a">iterator</a> <a class="code" href="classisis_1_1data_1_1Image.html#ade432319d06fc1638e617457d585e48d">end</a>();
<a name="l00431"></a>00431     <a class="code" href="classisis_1_1data_1_1Image.html#a21407a9c75b9ea3f50e52664d4f7a19e">const_iterator</a> <a class="code" href="classisis_1_1data_1_1Image.html#abf0729737cf6906a0aa6c1e830c0d728">begin</a>() <span class="keyword">const</span>;
<a name="l00432"></a>00432     <a class="code" href="classisis_1_1data_1_1Image.html#a21407a9c75b9ea3f50e52664d4f7a19e">const_iterator</a> <a class="code" href="classisis_1_1data_1_1Image.html#ade432319d06fc1638e617457d585e48d">end</a>() <span class="keyword">const</span>;
<a name="l00433"></a>00433 
<a name="l00439"></a>00439     <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#a27cfa5f9ced2077e578ad4bcc064e028" title="Get a chunk via index (and the lookup table).">getChunkAt</a> ( <span class="keywordtype">size_t</span> at, <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> ) <span class="keyword">const</span>;
<a name="l00440"></a>00440 
<a name="l00454"></a>00454     <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#afda7218833647cc6526950524775140d" title="Get the chunk that contains the voxel at the given coordinates.">getChunk</a> ( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0, <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> ) <span class="keyword">const</span>;
<a name="l00455"></a>00455 
<a name="l00468"></a>00468     <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#afda7218833647cc6526950524775140d" title="Get the chunk that contains the voxel at the given coordinates.">getChunk</a> ( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0, <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> );
<a name="l00469"></a>00469 
<a name="l00483"></a><a class="code" href="classisis_1_1data_1_1Image.html#a815e76cb9cc68006b2bbdad2cd9ded7c">00483</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TYPE&gt; <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#a815e76cb9cc68006b2bbdad2cd9ded7c" title="Get the chunk that contains the voxel at the given coordinates in the given type.">getChunkAs</a> ( <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0, <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> )<span class="keyword"> const </span>{
<a name="l00484"></a>00484         <span class="keywordflow">return</span> getChunkAs&lt;TYPE&gt; ( <a class="code" href="classisis_1_1data_1_1Image.html#a789138e66345f3e5a73c65dbf05b2940" title="for each chunk get the scaling (and offset) which would be used in an conversion to the given type...">getScalingTo</a> ( <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;TYPE&gt;::staticID</a> ), first, second, third, fourth, copy_metadata );
<a name="l00485"></a>00485     }
<a name="l00498"></a><a class="code" href="classisis_1_1data_1_1Image.html#a72a398bd1f12cb27bc33bf0e1c693995">00498</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TYPE&gt; <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> <a class="code" href="classisis_1_1data_1_1Image.html#a72a398bd1f12cb27bc33bf0e1c693995" title="Get the chunk that contains the voxel at the given coordinates in the given type (fast version)...">getChunkAs</a> ( <span class="keyword">const</span> scaling_pair &amp;scaling, <span class="keywordtype">size_t</span> first, <span class="keywordtype">size_t</span> second = 0, <span class="keywordtype">size_t</span> third = 0, <span class="keywordtype">size_t</span> fourth = 0, <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> )<span class="keyword"> const </span>{
<a name="l00499"></a>00499         <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> ret = <a class="code" href="classisis_1_1data_1_1Image.html#afda7218833647cc6526950524775140d" title="Get the chunk that contains the voxel at the given coordinates.">getChunk</a> ( first, second, third, fourth, copy_metadata ); <span class="comment">// get a cheap copy</span>
<a name="l00500"></a>00500         ret.<a class="code" href="classisis_1_1data_1_1Chunk.html#ae8607eff4f684c7934c9f4188a05e24c" title="Ensure, the chunk has the type with the requested ID.">convertToType</a> ( <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;TYPE&gt;::staticID</a>, scaling ); <span class="comment">// make it of type T</span>
<a name="l00501"></a>00501         <span class="keywordflow">return</span> ret; <span class="comment">//return that</span>
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503 
<a name="l00505"></a>00505     scaling_pair <a class="code" href="classisis_1_1data_1_1Image.html#a789138e66345f3e5a73c65dbf05b2940" title="for each chunk get the scaling (and offset) which would be used in an conversion to the given type...">getScalingTo</a> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> typeID, autoscaleOption scaleopt = autoscale ) <span class="keyword">const</span>;
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 
<a name="l00516"></a>00516     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#a14a33c4d2ba857b38c2188fb8e8abfd9" title="Insert a Chunk into the Image.">insertChunk</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> &amp;chunk );
<a name="l00522"></a>00522     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#a801a02eb15ae94b384aaa97061e2ad1c" title="(Re)computes the image layout and metadata.">reIndex</a>();
<a name="l00523"></a>00523 
<a name="l00525"></a>00525     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#a9fb0c9f8351fddc6a2fea609d487aa2b">isEmpty</a>() <span class="keyword">const</span>;
<a name="l00526"></a>00526 
<a name="l00532"></a>00532     std::list&lt;util::PropertyValue&gt; <a class="code" href="classisis_1_1data_1_1Image.html#a97524a597e61074c8b4b2e6e0ebdf8e6" title="Get a list of the properties of the chunks for the given key.">getChunksProperties</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1util_1_1PropertyMap.html#a22562fc95dac243746790a5c6a2aad85" title="type of the keys forming a path">util::PropertyMap::KeyType</a> &amp;key, <span class="keywordtype">bool</span> unique = <span class="keyword">false</span> ) <span class="keyword">const</span>;
<a name="l00533"></a>00533 
<a name="l00546"></a>00546     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#a3a243d63010a473066b4140c75553b57" title="Get the size (in bytes) for the voxels in the image.">getMaxBytesPerVoxel</a>() <span class="keyword">const</span>;
<a name="l00547"></a>00547 
<a name="l00553"></a><a class="code" href="classisis_1_1data_1_1Image.html#ae4bef75405f6729ab6c81191dc23bfc0">00553</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; std::pair&lt;T, T&gt; <a class="code" href="classisis_1_1data_1_1Image.html#ae4bef75405f6729ab6c81191dc23bfc0" title="Get the maximum and the minimum voxel value of the image.">getMinMaxAs</a>()<span class="keyword"> const </span>{
<a name="l00554"></a>00554         <a class="code" href="structisis_1_1util_1_1checkType.html" title="Templated pseudo struct to check for availability of a type at compile time.">util::checkType&lt;T&gt;</a>();<span class="comment">// works only for T from _internal::types</span>
<a name="l00555"></a>00555         std::pair&lt;util::ValueReference, util::ValueReference&gt; minmax = <a class="code" href="classisis_1_1data_1_1Image.html#ab437a008e59944a63c9fdc844c673ad6" title="Get the maximum and the minimum voxel value of the image as a pair of ValueReference-objects.">getMinMax</a>();
<a name="l00556"></a>00556         <span class="keywordflow">return</span> std::make_pair ( minmax.first-&gt;as&lt;T&gt;(), minmax.second-&gt;as&lt;T&gt;() );
<a name="l00557"></a>00557     }
<a name="l00558"></a>00558 
<a name="l00560"></a>00560     std::pair&lt;util::ValueReference, util::ValueReference&gt; <a class="code" href="classisis_1_1data_1_1Image.html#ab437a008e59944a63c9fdc844c673ad6" title="Get the maximum and the minimum voxel value of the image as a pair of ValueReference-objects.">getMinMax</a>() <span class="keyword">const</span>;
<a name="l00561"></a>00561 
<a name="l00566"></a>00566     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#a0750957ebf3422a0fbb3d029cc9b292a" title="Compares the voxel-values of this image to the given.">compare</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> &amp;comp ) <span class="keyword">const</span>;
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <a class="code" href="classisis_1_1data_1_1Image.html#ac83f7eecffd172b0c0759cb5ee7dd633">orientation</a> <a class="code" href="classisis_1_1data_1_1Image.html#a5d4c287dbd53f05174f3070029e19ce9">getMainOrientation</a>() <span class="keyword">const</span>;
<a name="l00569"></a>00569 
<a name="l00588"></a>00588     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#a10667fe639484021089fd983caaf58ea" title="Transforms the image coordinate system into an other system by multiplying the orientation matrix wit...">transformCoords</a> ( boost::numeric::ublas::matrix&lt;float&gt; transform_matrix, <span class="keywordtype">bool</span> transformCenterIsImageCenter = <span class="keyword">false</span> );
<a name="l00589"></a>00589 
<a name="l00603"></a>00603     <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3">dimensions</a> <a class="code" href="classisis_1_1data_1_1Image.html#a153f570319fc42ea6f1123a5a5eb309c" title="Maps the given scanner Axis to the dimension with the minimal angle.">mapScannerAxisToImageDimension</a> ( <a class="code" href="namespaceisis_1_1data.html#addc0484ee8054d9e855bbd264c978b99">scannerAxis</a> scannerAxes );
<a name="l00604"></a>00604 
<a name="l00611"></a>00611     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#a35f4ff9c8816a66469d7aaa5b693ae70" title="Computes the physical coordinates (in scanner space) of the given voxel index.">getPhysicalCoordsFromIndex</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1util_1_1vector4.html">util::ivector4</a> &amp;index ) <span class="keyword">const</span>;
<a name="l00612"></a>00612 
<a name="l00613"></a>00613 
<a name="l00620"></a>00620     <a class="code" href="classisis_1_1util_1_1vector4.html">util::ivector4</a> <a class="code" href="classisis_1_1data_1_1Image.html#a9d380dbc3dc9f40ebf8b6409e11d488c" title="Computes the voxel index of the given physical coordinates (coordinates in scanner space) This functi...">getIndexFromPhysicalCoords</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> &amp;physicalCoords ) <span class="keyword">const</span>;
<a name="l00621"></a>00621 
<a name="l00629"></a><a class="code" href="classisis_1_1data_1_1Image.html#a1849844422ad86be44556bbab0d55088">00629</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1Image.html#a1849844422ad86be44556bbab0d55088" title="Copy all voxel data of the image into memory.">copyToMem</a> ( T *dst, <span class="keywordtype">size_t</span> len,  scaling_pair scaling = scaling_pair() )<span class="keyword"> const </span>{
<a name="l00630"></a>00630         <span class="keywordflow">if</span> ( <a class="code" href="classisis_1_1data_1_1Image.html#a07dfbac4eb23def6dd10ab2182d98eeb">clean</a> ) {
<a name="l00631"></a>00631             <span class="keywordflow">if</span> ( scaling.first.isEmpty() || scaling.second.isEmpty() ) {
<a name="l00632"></a>00632                 scaling = <a class="code" href="classisis_1_1data_1_1Image.html#a789138e66345f3e5a73c65dbf05b2940" title="for each chunk get the scaling (and offset) which would be used in an conversion to the given type...">getScalingTo</a> ( <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;T&gt;::staticID</a> );
<a name="l00633"></a>00633             }
<a name="l00634"></a>00634 
<a name="l00635"></a>00635             <span class="comment">// we could do this using convertToType - but this solution does not need any additional temporary memory</span>
<a name="l00636"></a>00636             BOOST_FOREACH ( <span class="keyword">const</span> boost::shared_ptr&lt;Chunk&gt; &amp;ref, <a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a> ) {
<a name="l00637"></a>00637                 <span class="keyword">const</span> <span class="keywordtype">size_t</span> cSize = ref-&gt;getSizeAsVector().product();
<a name="l00638"></a>00638 
<a name="l00639"></a>00639                 <span class="keywordflow">if</span> ( !ref-&gt;copyToMem&lt;T&gt; ( dst, len, scaling ) ) {
<a name="l00640"></a>00640                     <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a15b301b1e8962fdf9562e683d7be5d9f">Runtime</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">error</a> ) &lt;&lt; <span class="stringliteral">&quot;Failed to copy raw data of type &quot;</span> &lt;&lt; ref-&gt;getTypeName() &lt;&lt; <span class="stringliteral">&quot; from image into memory of type &quot;</span> &lt;&lt; <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;T&gt;::staticName</a>();
<a name="l00641"></a>00641                 } <span class="keywordflow">else</span> {
<a name="l00642"></a>00642                     <span class="keywordflow">if</span> ( len &lt; cSize ) {
<a name="l00643"></a>00643                         <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a15b301b1e8962fdf9562e683d7be5d9f">Runtime</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">error</a> ) &lt;&lt; <span class="stringliteral">&quot;Abborting copy, because there is no space left in the target&quot;</span>;
<a name="l00644"></a>00644                         <span class="keywordflow">break</span>;
<a name="l00645"></a>00645                     }
<a name="l00646"></a>00646 
<a name="l00647"></a>00647                     len -= cSize;
<a name="l00648"></a>00648                 }
<a name="l00649"></a>00649 
<a name="l00650"></a>00650                 dst += ref-&gt;getVolume(); <span class="comment">// increment the cursor</span>
<a name="l00651"></a>00651             }
<a name="l00652"></a>00652         } <span class="keywordflow">else</span> {
<a name="l00653"></a>00653             <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a15b301b1e8962fdf9562e683d7be5d9f">Runtime</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">error</a> ) &lt;&lt; <span class="stringliteral">&quot;Cannot copy from non clean images. Run reIndex first&quot;</span>;
<a name="l00654"></a>00654         }
<a name="l00655"></a>00655     }
<a name="l00656"></a>00656 
<a name="l00667"></a><a class="code" href="classisis_1_1data_1_1Image.html#a5ef4434d95f796e456991e941c2e6751">00667</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classisis_1_1data_1_1MemChunk.html" title="Chunk class for memory-based buffers.">MemChunk&lt;T&gt;</a> <a class="code" href="classisis_1_1data_1_1Image.html#a5ef4434d95f796e456991e941c2e6751" title="Copy all voxel data into a new MemChunk.">copyAsMemChunk</a>()<span class="keyword"> const </span>{
<a name="l00668"></a>00668         <span class="keyword">const</span> <a class="code" href="classisis_1_1util_1_1vector4.html">util::vector4&lt;size_t&gt;</a> size = <a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#a498b4ebaa5ef654ebe41eacebe813e66" title="generates a FixedVector&amp;lt;DIMS&amp;gt; representing the size">getSizeAsVector</a>();
<a name="l00669"></a>00669         <a class="code" href="classisis_1_1data_1_1MemChunk.html" title="Chunk class for memory-based buffers.">data::MemChunk&lt;T&gt;</a> ret ( size[0], size[1], size[2], size[3] );
<a name="l00670"></a>00670         copyToMem&lt;T&gt; ( &amp;ret.<a class="code" href="classisis_1_1data_1_1Chunk.html#acf9c5e0311d80bed02a16362e2e0fc42" title="Gets a reference to the element at a given index.">voxel</a>&lt;T&gt;(0,0), ret.getVolume() );
<a name="l00671"></a>00671         <span class="keyword">static_cast&lt;</span><a class="code" href="classisis_1_1util_1_1PropertyMap.html" title="This class forms a mapping tree to store all kinds of properties (path : value), where:value is:a uti...">util::PropertyMap</a> &amp;<span class="keyword">&gt;</span>( ret ) = static_cast&lt;const util::PropertyMap &amp;&gt;( <a class="code" href="classisis_1_1data_1_1Image.html#a27cfa5f9ced2077e578ad4bcc064e028" title="Get a chunk via index (and the lookup table).">getChunkAt</a>( 0 ) );
<a name="l00672"></a>00672         <span class="keywordflow">return</span> ret;
<a name="l00673"></a>00673     }
<a name="l00674"></a>00674 
<a name="l00683"></a><a class="code" href="classisis_1_1data_1_1Image.html#ab94b524daf0b9172d90704c447f16e03">00683</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;T&gt;</a> <a class="code" href="classisis_1_1data_1_1Image.html#ab94b524daf0b9172d90704c447f16e03" title="Copy all voxel data into a new ValueArray.">copyAsValueArray</a>()<span class="keyword"> const </span>{
<a name="l00684"></a>00684         <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">data::ValueArray&lt;T&gt;</a> ret ( <a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#a5268e73b64b56929ec91d15204e29b4a" title="Get the size of the object in elements of TYPE.">getVolume</a>() );
<a name="l00685"></a>00685         copyToMem&lt;T&gt; ( ret.<a class="code" href="classisis_1_1data_1_1ValueArray.html#acf527fc5f2e1678f0c336889eccc5911">begin</a>().operator-&gt;(), ret.<a class="code" href="classisis_1_1data_1_1ValueArrayBase.html#a81bed4f18dff15ffe27fad3521eb0aeb">getLength</a>() );
<a name="l00686"></a>00686         <span class="keywordflow">return</span> ret;
<a name="l00687"></a>00687     }
<a name="l00694"></a>00694     <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1Image.html#ada16d33e2a19b88df23c393845ebd9a3" title="Copy all voxel data of the image into an existing ValueArray using its type.">copyToValueArray</a> ( <a class="code" href="classisis_1_1data_1_1ValueArrayBase.html">data::ValueArrayBase</a> &amp;dst,  scaling_pair scaling = scaling_pair() ) <span class="keyword">const</span>;
<a name="l00695"></a>00695 
<a name="l00703"></a>00703     <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> <a class="code" href="classisis_1_1data_1_1Image.html#aa79f18c9661aaca6db909453921eae22" title="Create a new Image of consisting of deep copied chunks.">copyByID</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ID = 0, scaling_pair scaling = scaling_pair() )<span class="keyword">const</span>;
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 
<a name="l00714"></a>00714     std::vector&lt;isis::data::Chunk&gt; <a class="code" href="classisis_1_1data_1_1Image.html#a2fd76bb61355c14ef7035e740b462a5e" title="Get a sorted list of the chunks of the image.">copyChunksToVector</a> ( <span class="keywordtype">bool</span> copy_metadata = <span class="keyword">true</span> ) <span class="keyword">const</span>;
<a name="l00715"></a>00715 
<a name="l00722"></a>00722     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#a2a6069b9490517355362b55e3af2424b" title="Ensure, the image has the type with the requested ID.">convertToType</a> ( <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ID, isis::data::autoscaleOption scaleopt = autoscale );
<a name="l00723"></a>00723 
<a name="l00728"></a>00728     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#a94fda5b511c9bfdff550d9691937aea1" title="Automatically splice the given dimension and all dimensions above.">spliceDownTo</a> ( <a class="code" href="namespaceisis_1_1data.html#a157a8a81ce7fb08f84af9c27b7d251a3">dimensions</a> dim );
<a name="l00729"></a>00729 
<a name="l00736"></a>00736     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#aac647fb29128d16d528059d481c79874" title="Run a functor with the base ChunkOp on every cunk in the image.">foreachChunk</a> ( <a class="code" href="classisis_1_1data_1_1ChunkOp.html" title="Base class for operators used for foreachChunk.">ChunkOp</a> &amp;op, <span class="keywordtype">bool</span> copyMetaData = <span class="keyword">false</span> );
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 
<a name="l00746"></a><a class="code" href="classisis_1_1data_1_1Image.html#a22b33e80caee653a22653f6aa04bd048">00746</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE&gt; <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#a22b33e80caee653a22653f6aa04bd048" title="Run a functor with the base VoxelOp on every chunk in the image.">foreachVoxel</a> ( <a class="code" href="classisis_1_1data_1_1VoxelOp.html">VoxelOp&lt;TYPE&gt;</a> &amp;op ) {
<a name="l00747"></a>00747         <span class="keyword">class </span>_proxy: <span class="keyword">public</span> <a class="code" href="classisis_1_1data_1_1ChunkOp.html" title="Base class for operators used for foreachChunk.">ChunkOp</a>
<a name="l00748"></a>00748         {
<a name="l00749"></a>00749             <a class="code" href="classisis_1_1data_1_1VoxelOp.html">VoxelOp&lt;TYPE&gt;</a> &amp;op;
<a name="l00750"></a>00750         <span class="keyword">public</span>:
<a name="l00751"></a>00751             _proxy ( <a class="code" href="classisis_1_1data_1_1VoxelOp.html">VoxelOp&lt;TYPE&gt;</a> &amp;_op ) : op ( _op ) {}
<a name="l00752"></a>00752             <span class="keywordtype">bool</span> operator() ( <a class="code" href="classisis_1_1data_1_1Chunk.html" title="Main class for four-dimensional random-access data blocks.">Chunk</a> &amp;ch, <a class="code" href="classisis_1_1util_1_1vector4.html">util::vector4&lt;size_t&gt;</a> posInImage ) {
<a name="l00753"></a>00753                 <span class="keywordflow">return</span> ch.<a class="code" href="classisis_1_1data_1_1Chunk.html#a99e5865871bcb988bcfd60ce81dcbb2c" title="Run a functor on every Voxel in the chunk.">foreachVoxel</a>&lt;TYPE&gt; ( op, posInImage ) == 0;
<a name="l00754"></a>00754             }
<a name="l00755"></a>00755         };
<a name="l00756"></a>00756         _proxy prx ( op );
<a name="l00757"></a>00757         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1Image.html#a2a6069b9490517355362b55e3af2424b" title="Ensure, the image has the type with the requested ID.">convertToType</a> ( <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">data::ValueArray&lt;TYPE&gt;::staticID</a> ) &amp;&amp; <a class="code" href="classisis_1_1data_1_1Image.html#aac647fb29128d16d528059d481c79874" title="Run a functor with the base ChunkOp on every cunk in the image.">foreachChunk</a> ( prx, <span class="keyword">false</span> );
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759 
<a name="l00761"></a>00761     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#ace627e4628e39615cbae3b6b43b9d915">getNrOfRows</a>() <span class="keyword">const</span>;
<a name="l00763"></a>00763     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#a01c02d76de0a741e527ff1e43b39422b">getNrOfColumns</a>() <span class="keyword">const</span>;
<a name="l00765"></a>00765     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#a922ea56dd2eb60fbb6e0299138dcde70">getNrOfSlices</a>() <span class="keyword">const</span>;
<a name="l00767"></a>00767     <span class="keywordtype">size_t</span> <a class="code" href="classisis_1_1data_1_1Image.html#a142c7b80e200d9822c28fc604bb031ee">getNrOfTimesteps</a>() <span class="keyword">const</span>;
<a name="l00768"></a>00768 
<a name="l00769"></a>00769     <a class="code" href="classisis_1_1util_1_1vector3.html">util::fvector3</a> <a class="code" href="classisis_1_1data_1_1Image.html#af19507da716adaa0a2ba4c9b8ea08005">getFoV</a>() <span class="keyword">const</span>;
<a name="l00770"></a>00770     <span class="keywordtype">bool</span> <a class="code" href="classisis_1_1data_1_1Image.html#aa2d4ca5ab19f210830ba7a871cb24406">updateOrientationMatrices</a>();
<a name="l00771"></a>00771 
<a name="l00781"></a>00781     std::string <a class="code" href="classisis_1_1data_1_1Image.html#ae125f95b23e6d29b100969883597ee9e" title="Generate a string identifying the image The identifier is made ofsequenceNumbersequenceDescription if...">identify</a>( <span class="keywordtype">bool</span> withpath = <span class="keyword">true</span> )<span class="keyword">const</span>;
<a name="l00782"></a>00782 };
<a name="l00783"></a>00783 
<a name="l00788"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html">00788</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1TypedImage.html" title="An Image where all chunks are guaranteed to have a specific type.">TypedImage</a>: <span class="keyword">public</span> <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a>
<a name="l00789"></a>00789 {
<a name="l00790"></a>00790 <span class="keyword">protected</span>:
<a name="l00791"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a071c1e7c3fe1b6e274b7330921b4f29c">00791</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html#a071c1e7c3fe1b6e274b7330921b4f29c">TypedImage</a>() {} <span class="comment">// to be used only by inheriting classes</span>
<a name="l00792"></a>00792 <span class="keyword">public</span>:
<a name="l00793"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a8bd93e9bf0e9140dc97704105720e5da">00793</a>     <span class="keyword">typedef</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">_internal::ImageIteratorTemplate&lt;data::ValueArray&lt;T&gt;</a> &gt; <a class="code" href="classisis_1_1data_1_1TypedImage.html#a8bd93e9bf0e9140dc97704105720e5da">iterator</a>;
<a name="l00794"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a12cf72b6d3c0c174e92d5bec191a2b86">00794</a>     <span class="keyword">typedef</span> <a class="code" href="classisis_1_1data_1_1__internal_1_1ImageIteratorTemplate.html" title="Generic iterator for voxels in Images.">_internal::ImageIteratorTemplate&lt;const data::ValueArray&lt;T&gt;</a> &gt; <a class="code" href="classisis_1_1data_1_1TypedImage.html#a12cf72b6d3c0c174e92d5bec191a2b86">const_iterator</a>;
<a name="l00795"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a8d8fe2a535b6429d38fcab5576132d6a">00795</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> iterator::reference <a class="code" href="classisis_1_1data_1_1TypedImage.html#a8d8fe2a535b6429d38fcab5576132d6a">reference</a>;
<a name="l00796"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#aacdc5f9d936c90b39eddc2c4db8d2827">00796</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> const_iterator::reference <a class="code" href="classisis_1_1data_1_1TypedImage.html#aacdc5f9d936c90b39eddc2c4db8d2827">const_reference</a>;
<a name="l00798"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a05f095de7c8b6146f067769591d7f0c5">00798</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html#a05f095de7c8b6146f067769591d7f0c5" title="cheap copy another Image and make sure all chunks have type T">TypedImage</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> &amp;src ) : <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> ( src ) { <span class="comment">// ok we just copied the whole image</span>
<a name="l00799"></a>00799         <span class="comment">//but we want it to be of type T</span>
<a name="l00800"></a>00800         <a class="code" href="classisis_1_1data_1_1Image.html#a2a6069b9490517355362b55e3af2424b" title="Ensure, the image has the type with the requested ID.">convertToType</a> ( <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;T&gt;::staticID</a> );
<a name="l00801"></a>00801     }
<a name="l00803"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a39da1b4e2f0785e43efa6a3a797e416b">00803</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html" title="An Image where all chunks are guaranteed to have a specific type.">TypedImage</a> &amp;<a class="code" href="classisis_1_1data_1_1TypedImage.html#a39da1b4e2f0785e43efa6a3a797e416b" title="cheap copy another TypedImage">operator= </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html" title="An Image where all chunks are guaranteed to have a specific type.">TypedImage</a> &amp;ref ) { <span class="comment">//its already of the given type - so just copy it</span>
<a name="l00804"></a>00804         <a class="code" href="classisis_1_1data_1_1TypedImage.html#a39da1b4e2f0785e43efa6a3a797e416b" title="cheap copy another TypedImage">Image::operator= </a>( ref );
<a name="l00805"></a>00805         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00806"></a>00806     }
<a name="l00808"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a16654e67097e9e70a1bcc16b84bdd640">00808</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html" title="An Image where all chunks are guaranteed to have a specific type.">TypedImage</a> &amp;<a class="code" href="classisis_1_1data_1_1TypedImage.html#a39da1b4e2f0785e43efa6a3a797e416b" title="cheap copy another TypedImage">operator= </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> &amp;ref ) { <span class="comment">// copy the image, and make sure its of the given type</span>
<a name="l00809"></a>00809         <a class="code" href="classisis_1_1data_1_1TypedImage.html#a39da1b4e2f0785e43efa6a3a797e416b" title="cheap copy another TypedImage">Image::operator= </a>( ref );
<a name="l00810"></a>00810         <a class="code" href="classisis_1_1data_1_1Image.html#a2a6069b9490517355362b55e3af2424b" title="Ensure, the image has the type with the requested ID.">convertToType</a> ( <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;T&gt;::staticID</a> );
<a name="l00811"></a>00811         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00812"></a>00812     }
<a name="l00813"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a32b8263ed887ddf4ad21fdb35796aacd">00813</a>     <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html#a32b8263ed887ddf4ad21fdb35796aacd">copyToMem</a> ( <span class="keywordtype">void</span> *dst ) {
<a name="l00814"></a>00814         Image::copyToMem&lt;T&gt; ( ( T * ) dst );
<a name="l00815"></a>00815     }
<a name="l00816"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#aa76b45b6e85fa810e63b472bde5f25f8">00816</a>     <span class="keywordtype">void</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html#aa76b45b6e85fa810e63b472bde5f25f8">copyToMem</a> ( <span class="keywordtype">void</span> *dst )<span class="keyword"> const </span>{
<a name="l00817"></a>00817         Image::copyToMem&lt;T&gt; ( ( T * ) dst );
<a name="l00818"></a>00818     }
<a name="l00819"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#ae0eb2a2c2e9862d8730239d7afb3aec2">00819</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html#a8bd93e9bf0e9140dc97704105720e5da">iterator</a> <a class="code" href="classisis_1_1data_1_1TypedImage.html#ae0eb2a2c2e9862d8730239d7afb3aec2">begin</a>() {
<a name="l00820"></a>00820         <span class="keywordflow">if</span> ( <a class="code" href="classisis_1_1data_1_1Image.html#acd213fa6d0856d45e6413801f9bdec66">checkMakeClean</a>() ) {
<a name="l00821"></a>00821             std::vector&lt;data::ValueArray&lt;T&gt;*&gt; vec ( <a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a>.size() );
<a name="l00822"></a>00822 
<a name="l00823"></a>00823             <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a>.size(); i++ )
<a name="l00824"></a>00824                 vec[i] = &amp;<a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a>[i]-&gt;<span class="keyword">template</span> asValueArray&lt;T&gt;();
<a name="l00825"></a>00825 
<a name="l00826"></a>00826             <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html#a8bd93e9bf0e9140dc97704105720e5da">iterator</a> ( vec );
<a name="l00827"></a>00827         } <span class="keywordflow">else</span> {
<a name="l00828"></a>00828             <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">error</a> )  &lt;&lt; <span class="stringliteral">&quot;Image is not clean. Returning empty iterator ...&quot;</span>;
<a name="l00829"></a>00829             <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html#a8bd93e9bf0e9140dc97704105720e5da">iterator</a>();
<a name="l00830"></a>00830         }
<a name="l00831"></a>00831     }
<a name="l00832"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a510cd35b1115a31a26c5d7b231d67907">00832</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html#a8bd93e9bf0e9140dc97704105720e5da">iterator</a> <a class="code" href="classisis_1_1data_1_1TypedImage.html#a510cd35b1115a31a26c5d7b231d67907">end</a>() {
<a name="l00833"></a>00833         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html#ae0eb2a2c2e9862d8730239d7afb3aec2">begin</a>() + <a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#a5268e73b64b56929ec91d15204e29b4a" title="Get the size of the object in elements of TYPE.">getVolume</a>();
<a name="l00834"></a>00834     };
<a name="l00835"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#ae03769fb22a4b5b013cf1a0d8c2a409c">00835</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html#a12cf72b6d3c0c174e92d5bec191a2b86">const_iterator</a> <a class="code" href="classisis_1_1data_1_1TypedImage.html#ae03769fb22a4b5b013cf1a0d8c2a409c">begin</a>()<span class="keyword"> const </span>{
<a name="l00836"></a>00836         <span class="keywordflow">if</span> ( <a class="code" href="classisis_1_1data_1_1Image.html#a102fa197eedd6a7cc8642254be953656">isClean</a>() ) {
<a name="l00837"></a>00837             std::vector&lt;const data::ValueArray&lt;T&gt;*&gt; vec ( <a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a>.size() );
<a name="l00838"></a>00838 
<a name="l00839"></a>00839             <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a>.size(); i++ )
<a name="l00840"></a>00840                 vec[i] = &amp;<a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a>[i]-&gt;<span class="keyword">template</span> asValueArray&lt;T&gt;();
<a name="l00841"></a>00841 
<a name="l00842"></a>00842             <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html#a12cf72b6d3c0c174e92d5bec191a2b86">const_iterator</a> ( vec );
<a name="l00843"></a>00843         } <span class="keywordflow">else</span> {
<a name="l00844"></a>00844             <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82a41a0a4591faa6079940551ad22c43597">error</a> )  &lt;&lt; <span class="stringliteral">&quot;Image is not clean. Returning empty iterator ...&quot;</span>;
<a name="l00845"></a>00845             <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html#a12cf72b6d3c0c174e92d5bec191a2b86">const_iterator</a>();
<a name="l00846"></a>00846         }
<a name="l00847"></a>00847     }
<a name="l00848"></a><a class="code" href="classisis_1_1data_1_1TypedImage.html#a7d6e6d04889c61bb9899df125ec2939e">00848</a>     <a class="code" href="classisis_1_1data_1_1TypedImage.html#a12cf72b6d3c0c174e92d5bec191a2b86">const_iterator</a> <a class="code" href="classisis_1_1data_1_1TypedImage.html#a7d6e6d04889c61bb9899df125ec2939e">end</a>()<span class="keyword"> const </span>{
<a name="l00849"></a>00849         <span class="keywordflow">return</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html#ae0eb2a2c2e9862d8730239d7afb3aec2">begin</a>() + <a class="code" href="classisis_1_1data_1_1__internal_1_1NDimensional.html#a5268e73b64b56929ec91d15204e29b4a" title="Get the size of the object in elements of TYPE.">getVolume</a>();
<a name="l00850"></a>00850     };
<a name="l00851"></a>00851 };
<a name="l00852"></a>00852 
<a name="l00857"></a><a class="code" href="classisis_1_1data_1_1MemImage.html">00857</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classisis_1_1data_1_1MemImage.html" title="An Image which always uses its own memory and a specific type.">MemImage</a>: <span class="keyword">public</span> <a class="code" href="classisis_1_1data_1_1TypedImage.html" title="An Image where all chunks are guaranteed to have a specific type.">TypedImage</a>&lt;T&gt;
<a name="l00858"></a>00858 {
<a name="l00859"></a>00859 <span class="keyword">public</span>:
<a name="l00865"></a><a class="code" href="classisis_1_1data_1_1MemImage.html#a7bcae94f698adcb22d4ec30b8075d40b">00865</a>     <a class="code" href="classisis_1_1data_1_1MemImage.html#a7bcae94f698adcb22d4ec30b8075d40b" title="Copy contructor.">MemImage</a> ( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> &amp;src ) {
<a name="l00866"></a>00866         <a class="code" href="classisis_1_1data_1_1MemImage.html#a734d63e8c8c9d1eec740522451662f7f" title="Copy operator.">operator= </a>( src );
<a name="l00867"></a>00867     }
<a name="l00868"></a>00868 
<a name="l00874"></a><a class="code" href="classisis_1_1data_1_1MemImage.html#a734d63e8c8c9d1eec740522451662f7f">00874</a>     <a class="code" href="classisis_1_1data_1_1MemImage.html" title="An Image which always uses its own memory and a specific type.">MemImage</a> &amp;<a class="code" href="classisis_1_1data_1_1MemImage.html#a734d63e8c8c9d1eec740522451662f7f" title="Copy operator.">operator= </a>( <span class="keyword">const</span> <a class="code" href="classisis_1_1data_1_1Image.html" title="Main class for generic 4D-images.">Image</a> &amp;ref ) { <span class="comment">// copy the image, and make sure its of the given type</span>
<a name="l00875"></a>00875 
<a name="l00876"></a>00876         <a class="code" href="classisis_1_1data_1_1MemImage.html#a734d63e8c8c9d1eec740522451662f7f" title="Copy operator.">Image::operator= </a>( ref ); <span class="comment">// ok we just copied the whole image</span>
<a name="l00877"></a>00877 
<a name="l00878"></a>00878         <span class="comment">//we want deep copies of the chunks, and we want them to be of type T</span>
<a name="l00879"></a>00879         <span class="keyword">struct </span>: _internal::SortedChunkList::chunkPtrOperator {
<a name="l00880"></a>00880             std::pair&lt;util::ValueReference, util::ValueReference&gt; scale;
<a name="l00881"></a>00881             boost::shared_ptr&lt;Chunk&gt; operator() ( <span class="keyword">const</span> boost::shared_ptr&lt; Chunk &gt;&amp; ptr ) {
<a name="l00882"></a>00882                 <span class="keywordflow">return</span> boost::shared_ptr&lt;Chunk&gt; ( <span class="keyword">new</span> <a class="code" href="classisis_1_1data_1_1MemChunk.html" title="Chunk class for memory-based buffers.">MemChunk&lt;T&gt;</a> ( *ptr, scale ) );
<a name="l00883"></a>00883             }
<a name="l00884"></a>00884         } conv_op;
<a name="l00885"></a>00885         conv_op.scale = ref.<a class="code" href="classisis_1_1data_1_1Image.html#a789138e66345f3e5a73c65dbf05b2940" title="for each chunk get the scaling (and offset) which would be used in an conversion to the given type...">getScalingTo</a> ( <a class="code" href="classisis_1_1data_1_1ValueArray.html" title="Generic class for type (and length) - aware pointers.">ValueArray&lt;T&gt;::staticID</a> );
<a name="l00886"></a>00886         <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82ad97a38c0fafe61d63fdb883c85d0067a">info</a> ) &lt;&lt; <span class="stringliteral">&quot;Computed scaling for conversion from source image: [&quot;</span> &lt;&lt; conv_op.scale &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;
<a name="l00887"></a>00887 
<a name="l00888"></a>00888         this-&gt;<span class="keyword">set</span>.transform ( conv_op );
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <span class="keywordflow">if</span> ( ref.<a class="code" href="classisis_1_1data_1_1Image.html#a102fa197eedd6a7cc8642254be953656">isClean</a>() ) {
<a name="l00891"></a>00891             this-&gt;<a class="code" href="classisis_1_1data_1_1Image.html#a9c80a4fa8768d5df1c8bf67129e2cae9">lookup</a> = this-&gt;<span class="keyword">set</span>.getLookup(); <span class="comment">// the lookup table still points to the old chunks</span>
<a name="l00892"></a>00892         } <span class="keywordflow">else</span> {
<a name="l00893"></a>00893             <a class="code" href="log_8hpp.html#adf04aa30f03b88d867f551c7d349f738">LOG</a> ( <a class="code" href="namespaceisis_1_1data.html#a1fa5e73edba41053e31839cba7134dbd">Debug</a>, <a class="code" href="namespaceisis.html#afe55030315ca143f9be26fd278df9f82ad97a38c0fafe61d63fdb883c85d0067a">info</a> ) &lt;&lt; <span class="stringliteral">&quot;Copied unclean image. Running reIndex on the copy.&quot;</span>;
<a name="l00894"></a>00894             this-&gt;<a class="code" href="classisis_1_1data_1_1Image.html#a801a02eb15ae94b384aaa97061e2ad1c" title="(Re)computes the image layout and metadata.">reIndex</a>();
<a name="l00895"></a>00895         }
<a name="l00896"></a>00896 
<a name="l00897"></a>00897         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00898"></a>00898     }
<a name="l00899"></a>00899 };
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 }
<a name="l00902"></a>00902 }
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 <span class="preprocessor">#endif // IMAGE_H</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Oct 4 2012 17:49:14 for ISIS Core Library by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
